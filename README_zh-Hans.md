<p align="center">
  <img src=".github/node-js-cli-apps-best-practices.png" height="400px" />
</p>

<p align="center">
  <h1 align="center">Node.js CLI åº”ç”¨ç¨‹åºæœ€ä½³å®è·µ</h1>
ä¸€ä¸ªå…³äºå¦‚ä½•æ„å»ºæˆåŠŸï¼Œå¯Œæœ‰åŒæƒ…å¿ƒä¸”ç”¨æˆ·å‹å¥½çš„ Node.js å‘½ä»¤è¡Œç•Œé¢ï¼ˆCLIï¼‰åº”ç”¨ç¨‹åºçš„ç²¾é€‰æœ€ä½³å®è·µçš„é›†åˆã€‚
</p>

### ä¸ºä»€ä¹ˆä½¿ç”¨æœ¬æŒ‡å—ï¼Ÿ

ä¸€ä¸ªç³Ÿç³•çš„ CLI ä¼šå¾ˆè½»æ˜“æ‰“æ–­ç”¨æˆ·ä¸å…¶ä¹‹é—´çš„äº¤äº’ã€‚æ„å»ºæˆåŠŸçš„ CLI éœ€è¦å…³æ³¨ç»†èŠ‚ä»¥åŠå¯¹ç”¨æˆ·çš„åŒç†å¿ƒï¼Œä»¥ä¾¿åˆ›é€ è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒã€‚è¿™éå¸¸å®¹æ˜“å‡ºé”™ã€‚ åœ¨æœ¬æŒ‡å—ä¸­ï¼Œæˆ‘æ•´ç†äº†ä¸€ä¸ªé‡ç‚¹é¢†åŸŸçš„æœ€ä½³å®è·µåˆ—è¡¨ï¼Œæ—¨åœ¨ä¼˜åŒ–ä¸ CLI åº”ç”¨ç¨‹åºäº¤äº’æ—¶çš„ç†æƒ³ç”¨æˆ·ä½“éªŒã€‚ è¿™å¾ˆå®¹æ˜“å‡ºé”™

åœ¨æœ¬æŒ‡å—ä¸­ï¼Œæˆ‘æ•´ç†äº†ä¸€ä¸ªé‡ç‚¹é¢†åŸŸçš„æœ€ä½³å®è·µåˆ—è¡¨ï¼Œç›®çš„æ˜¯åœ¨ä¼˜åŒ–ä¸ CLI åº”ç”¨ç¨‹åºäº¤äº’æ—¶çš„ç†æƒ³ç”¨æˆ·ä½“éªŒã€‚

### ç‰¹ç‚¹:

- âœ… 36 best practices for building successful Node.js CLI applications
- âœ… Read in a different language: [ğŸ‡¨ğŸ‡³](./README_zh-Hans.md), [ğŸ‡ªğŸ‡¸](./README_es.md), or [help translate](https://crowdin.com/project/nodejs-cli-apps-best-practices) to other languages. [Suggest new languages](https://crowdin.com/project/nodejs-cli-apps-best-practices/discussions).
- ğŸ™ æ¬¢è¿è´¡çŒ®

<!-- Shields -->
<p align="center">
<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img src="https://badgen.net/badge/License/CC BY-SA 4.0/green"/></a>
<img src="https://badgen.net/badge/Last%20Update/Oct%202023/green" />
<a href="https://www.github.com/lirantal/nodejs-cli-apps-best-practices" target="_blank">
  <img src="https://badgen.net/badge/Node.js CLI Apps/Best Practices/purple" alt="Node.js CLI Apps Best Practices"/>
</a>
<a href="https://crowdin.com/project/nodejs-cli-apps-best-practices" target="_blank">
  <img src="https://badges.crowdin.net/nodejs-cli-apps-best-practices/localized.svg"/>
</a>
</p>

### ä¸ºä»€ä¹ˆæ˜¯æˆ‘ï¼Ÿ

å—¨ï¼Œæˆ‘æ˜¯ [Liran Tal](https://twitter.com/liran_tal)ï¼Œæˆ‘æ²‰è¿·äºæ„å»ºå‘½ä»¤è¡Œåº”ç”¨ç¨‹åºã€‚

æˆ‘æœ€è¿‘çš„ä¸€äº›å·¥ä½œï¼Œæ„å»º Node.js CLIï¼ŒåŒ…æ‹¬ä»¥ä¸‹å¼€æºé¡¹ç›®ï¼š

<!-- prettier-ignore-start -->
<!-- markdownlint-disable -->
<table>
  <tr>
     <td align="center">
      <a href="https://github.com/lirantal/dockly"><img width="150px;" alt="dockly - Immersive terminal interface for managing docker containers and services" src="https://repository-images.githubusercontent.com/71667498/d5576f00-69cd-11e9-83dd-2139ad967fdc"><br><sub><b>Dockly</b></sub></a><br>ç”¨äºç®¡ç† docker å®¹å™¨å’ŒæœåŠ¡çš„æ²‰æµ¸å¼ç»ˆç«¯ç•Œé¢
     </td>
     <td align="center">
      <a href="https://github.com/lirantal/npq"><img width="150px;" alt="npq - safely install packages with npm/yarn by auditing them as part of your install process" src="https://repository-images.githubusercontent.com/114298694/73d29f00-bb7d-11e9-80f5-5f94f25a76b4"><br><sub><b>npq</b></sub></a><br>é€šè¿‡å°†è½¯ä»¶åŒ…ä½œä¸ºå®‰è£…è¿‡ç¨‹çš„ä¸€éƒ¨åˆ†è¿›è¡Œå®¡æ ¸ï¼Œä½¿ç”¨ npm/yarn å®‰å…¨å®‰è£…è½¯ä»¶åŒ…
     </td>
     <td align="center">
      <a href="https://github.com/lirantal/lockfile-lint"><img width="150px;" alt="lockfile-lint - Lint an npm or yarn lockfile to analyze and detect security issues" src="https://repository-images.githubusercontent.com/189734318/d2d03200-5bfb-11ea-9eb6-70144dbe2197"><br><sub><b>lockfile-lint</b></sub></a><br>åˆ›å»º npm æˆ– yarn é”å®šæ–‡ä»¶ä»¥åˆ†æå’Œæ£€æµ‹å®‰å…¨é—®é¢˜
     </td>
     <td align="center">
      <a href="https://github.com/lirantal/is-website-vulnerable"><img width="150px;" alt="is-website-vulnerable - finds publicly known security vulnerabilities in a website's frontend JavaScript libraries" src="https://repository-images.githubusercontent.com/212983914/2d33b500-e84d-11e9-820e-799f368c4c44"><br><sub><b>is-website-vulnerable</b></sub></a><br>åœ¨ç½‘ç«™çš„å‰ç«¯ JavaScript åº“ä¸­æŸ¥æ‰¾å·²çŸ¥çš„å®‰å…¨æ¼æ´
     </td>
  </tr>
</table>
<!-- markdownlint-enable -->
<!-- prettier-ignore-end -->

### è¯¥å›¢é˜Ÿ âœ¨

æ„Ÿè°¢è¿™äº›ä¼˜ç§€çš„äººä»¬([è¡¨æƒ…ç¬¦å·é”®](https://allcontributors.org/docs/en/emoji-key) ):

<!-- ALL-CONTRIBUTORS-LIST:START - Do not remove or modify this section -->
<!-- prettier-ignore-start -->
<!-- markdownlint-disable -->
<table>
  <tr>
    <td align="center"><a href="https://blog.vvni.top/"><img src="https://avatars2.githubusercontent.com/u/50414099?v=4" width="100px;" alt=""/><br /><sub><b>Vanilla</b></sub></a><br /><a href="#translation-vvni" title="Translation">ğŸŒ</a></td>
    <td align="center"><a href="https://terkel.com"><img src="https://avatars2.githubusercontent.com/u/2302254?v=4" width="100px;" alt=""/><br /><sub><b>Terkel</b></sub></a><br /><a href="#content-terkelg" title="Content">ğŸ–‹</a></td>
    <td align="center"><a href="http://jasonkarns.com"><img src="https://avatars2.githubusercontent.com/u/119972?v=4" width="100px;" alt=""/><br /><sub><b>Jason Karns</b></sub></a><br /><a href="#content-jasonkarns" title="Content">ğŸ–‹</a></td>
    <td align="center"><a href="https://about.me/davesag"><img src="https://avatars0.githubusercontent.com/u/387098?v=4" width="100px;" alt=""/><br /><sub><b>Dave Sag</b></sub></a><br /><a href="#maintenance-davesag" title="Maintenance">ğŸš§</a></td>
    <td align="center"><a href="https://josejpr.com"><img src="https://avatars0.githubusercontent.com/u/12954959?v=4" width="100px;" alt=""/><br /><sub><b>JosÃ© J. PÃ©rez Rivas</b></sub></a><br /><a href="#translation-JoseJPR" title="Translation">ğŸŒ</a></td>
    <td align="center"><a href="https://twitter.com/MSuresh100"><img src="https://avatars3.githubusercontent.com/u/12813750?v=4" width="100px;" alt=""/><br /><sub><b>Sureshraj</b></sub></a><br /><a href="#content-m-sureshraj" title="Content">ğŸ–‹</a></td>
  </tr>
</table>

<!-- markdownlint-enable -->
<!-- prettier-ignore-end -->

<!-- ALL-CONTRIBUTORS-LIST:END -->

---

<h3>ç›®å½•</h3>

- 1 å‘½ä»¤è¡Œä½“éªŒ
  - 1.1 [éµå®ˆ POSIX å‚æ•°](#11-%E9%81%B5%E5%AE%88POSIX%E5%8F%82%E6%95%B0)
  - 1.2 [æ„å»ºå¯Œæœ‰åŒç†å¿ƒçš„ CLI](#12-%E6%9E%84%E5%BB%BA%E5%AF%8C%E6%9C%89%E5%90%8C%E7%90%86%E5%BF%83%E7%9A%84CLI)
  - 1.3 [æœ‰çŠ¶æ€æ•°æ®](#13-%E6%9C%89%E7%8A%B6%E6%80%81%E6%95%B0%E6%8D%AE)
  - 1.4 [æä¾›å¯Œæœ‰è‰²å½©çš„ä½“éªŒ](#14-%E6%8F%90%E4%BE%9B%E5%AF%8C%E6%9C%89%E8%89%B2%E5%BD%A9%E7%9A%84%E4%BD%93%E9%AA%8C)
  - 1.5 [ä¸°å¯Œçš„äº¤äº’](#15-%E4%B8%B0%E5%AF%8C%E7%9A%84%E4%BA%A4%E4%BA%92)
  - 1.6 [æ— å¤„ä¸åœ¨çš„è¶…é“¾æ¥](#16-%E6%97%A0%E5%A4%84%E4%B8%8D%E5%9C%A8%E7%9A%84%E8%B6%85%E9%93%BE%E6%8E%A5)
  - 1.7 [é›¶é…ç½®](#17-%E9%9B%B6%E9%85%8D%E7%BD%AE)
  - 1.8 [éµå®ˆ POSIX ä¿¡å·](#18-%E9%81%B5%E5%AE%88POSIX%E4%BF%A1%E5%8F%B7)
- 2 åˆ†å‘
  - 2.1 [é€‰æ‹©å ç”¨è¾ƒå°çš„ä¾èµ–é¡¹](#21-%E9%80%89%E6%8B%A9%E5%8D%A0%E7%94%A8%E8%BE%83%E5%B0%8F%E7%9A%84%E4%BE%9D%E8%B5%96%E9%A1%B9)
  - 2.2 [ä½¿ç”¨ shrinkwrap, Luke](#22-%E4%BD%BF%E7%94%A8shrinkwrap,-Luke)
  - 2.3 [æ¸…ç†é…ç½®æ–‡ä»¶](#23-æ¸…ç†é…ç½®æ–‡ä»¶)
- 3 äº’é€šæ€§
  - 3.1 [æ¥å— STDIN è¾“å…¥](#31-%E6%8E%A5%E5%8F%97STDIN%E8%BE%93%E5%85%A5)
  - 3.2 [å¯ç”¨ç»“æ„åŒ–è¾“å‡º](#32-%E5%90%AF%E7%94%A8%E7%BB%93%E6%9E%84%E5%8C%96%E8%BE%93%E5%87%BA)
  - 3.3 [è·¨å¹³å°è§„èŒƒ](#33-%E8%B7%A8%E5%B9%B3%E5%8F%B0%E8%A7%84%E8%8C%83)
  - 3.4 [æ”¯æŒé…ç½®ä¼˜å…ˆ](#34-æ”¯æŒé…ç½®ä¼˜å…ˆ)
- 4 è¾…åŠ©åŠŸèƒ½
  - 4.1 [å®¹å™¨åŒ– CLI](#41-%E5%AE%B9%E5%99%A8%E5%8C%96CLI)
  - 4.2 [ä¼˜é›…é™çº§](#42-%E4%BC%98%E9%9B%85%E9%99%8D%E7%BA%A7)
  - 4.3 [Node.js ç‰ˆæœ¬å…¼å®¹æ€§](#43-Node.js%E7%89%88%E6%9C%AC%E5%85%BC%E5%AE%B9%E6%80%A7)
  - 4.4 [Shebang è‡ªåŠ¨æ£€æµ‹ Node.js è¿è¡Œæ—¶](#44-Shebang%E8%87%AA%E5%8A%A8%E6%A3%80%E6%B5%8BNode.js%E8%BF%90%E8%A1%8C%E6%97%B6)
- 5 æµ‹è¯•
  - 5.1 [ä¸ä¿¡ä»»è¯­è¨€ç¯å¢ƒ](#51-ä¸ä¿¡ä»»è¯­è¨€ç¯å¢ƒ)
- 6 é”™è¯¯
  - 6.1 [å¯è¿½è¸ªçš„é”™è¯¯](#61-å¯è¿½è¸ªçš„é”™è¯¯)
  - 6.2 [å¯è¡Œæ€§é”™è¯¯](#62-%E5%8F%AF%E8%A1%8C%E6%80%A7%E9%94%99%E8%AF%AF)
  - 6.3 [æä¾›è°ƒè¯•æ¨¡å¼](#63-%E6%8F%90%E4%BE%9B%E8%B0%83%E8%AF%95%E6%A8%A1%E5%BC%8F)
  - 6.4 [æ­£ç¡®ä½¿ç”¨é€€å‡ºä»£ç ](#64-%E6%AD%A3%E7%A1%AE%E4%BD%BF%E7%94%A8%E9%80%80%E5%87%BA%E4%BB%A3%E7%A0%81)
  - 6.5 [è½»æ¾çš„é”™è¯¯æŠ¥å‘Š](#65-è½»æ¾çš„é”™è¯¯æŠ¥å‘Š)
- 7 å¼€å‘
  - 7.1 [ä½¿ç”¨ bin å¯¹è±¡](#71-%E4%BD%BF%E7%94%A8bin%E5%AF%B9%E8%B1%A1)
  - 7.2 [ä½¿ç”¨ç›¸å¯¹è·¯å¾„](#72-ä½¿ç”¨ç›¸å¯¹è·¯å¾„)
  - 7.3 [ä½¿ç”¨ files å­—æ®µ](#73-ä½¿ç”¨fileså­—æ®µ)
- 8 åˆ†æ
  - 8.1 [ä¸¥æ ¼é€‰æ‹©åŠ å…¥åˆ†æ](#81-ä¸¥æ ¼é€‰æ‹©åŠ å…¥åˆ†æ)
- 9 Versioning
  - 9.1 [Include a `--version` Flag](#91-include-a---version-flag)
  - 9.2 [Use Semantic Versioning](#92-use-semantic-versioning)
  - 9.3 [Provide Version Information in a 'package.json' file](#93-provide-version-information-in-a-packagejson-file)
  - 9.4 [Display Version in Error Messages and Help Text](#94-display-version-in-error-messages-and-help-text)
  - 9.5 [Backward Compatibility](#95-backward-compatibility)
  - 9.6 [Publish Versioned Releases on npm](#96-publish-versioned-releases-on-npm)
  - 9.7 [Update Your App's Version Documents](#97-update-your-apps-version-documents)
- 10 Appendix: CLI Frameworks
  - 10.1 [CLI Frameworks Table](#101-cli-frameworks-table)
- 11 Appendix: CLI educational resources

---

# 1 å‘½ä»¤è¡Œä½“éªŒ

æœ¬èŠ‚ä»‹ç»æœ‰å…³åˆ›å»ºæ¼‚äº®ä¸”é«˜ä»·å€¼ç”¨æˆ·ä½“éªŒçš„ Node.js å‘½ä»¤è¡Œåº”ç”¨ç¨‹åºæœ€ä½³å®è·µã€‚

åœ¨æœ¬èŠ‚ä¸­ï¼š

- 1.1 [éµå®ˆ POSIX å‚æ•°](#11-%E9%81%B5%E5%AE%88POSIX%E5%8F%82%E6%95%B0)
- 1.2 [æ„å»ºå¯Œæœ‰åŒç†å¿ƒçš„ CLI](#12-%E6%9E%84%E5%BB%BA%E5%AF%8C%E6%9C%89%E5%90%8C%E7%90%86%E5%BF%83%E7%9A%84CLI)
- 1.3 [æœ‰çŠ¶æ€æ•°æ®](#13-%E6%9C%89%E7%8A%B6%E6%80%81%E6%95%B0%E6%8D%AE)
- 1.4 [æä¾›å¯Œæœ‰è‰²å½©çš„ä½“éªŒ](#14-%E6%8F%90%E4%BE%9B%E5%AF%8C%E6%9C%89%E8%89%B2%E5%BD%A9%E7%9A%84%E4%BD%93%E9%AA%8C)
- 1.5 [ä¸°å¯Œçš„äº¤äº’](#15-%E4%B8%B0%E5%AF%8C%E7%9A%84%E4%BA%A4%E4%BA%92)
- 1.6 [æ— å¤„ä¸åœ¨çš„è¶…é“¾æ¥](#16-%E6%97%A0%E5%A4%84%E4%B8%8D%E5%9C%A8%E7%9A%84%E8%B6%85%E9%93%BE%E6%8E%A5)
- 1.7 [é›¶é…ç½®](#17-%E9%9B%B6%E9%85%8D%E7%BD%AE)
- 1.8 [éµå®ˆ POSIX ä¿¡å·](#18-%E9%81%B5%E5%AE%88POSIX%E4%BF%A1%E5%8F%B7)

<br/>

### 1.1 éµå®ˆ POSIX å‚æ•°

âœ… **å¯è¡Œ:** ä½¿ç”¨ [å…¼å®¹ POSIX](https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap12.html) çš„å‘½ä»¤è¡Œå‚æ•°è¯­æ³•ï¼Œè¯¥è¯­æ³•å·²è¢«å¹¿æ³›æ¥å—ä¸ºå‘½ä»¤è¡Œå·¥å…·çš„æ ‡å‡†ã€‚

âŒ **å¦åˆ™:** å½“ CLI çš„å‚æ•°ã€é€‰é¡¹æˆ–å‘½ä»¤å‚æ•°çš„è¯­æ³•åç¦»ä»–ä»¬ä¹ æƒ¯çš„ Unix æ ‡å‡†æ—¶ï¼Œç”¨æˆ·å¯èƒ½ä¼šæ„Ÿåˆ°è‹¦æ¼ã€‚

â„¹ï¸ **è¯¦æƒ…**

ç±» Unix çš„æ“ä½œç³»ç»Ÿæ™®åŠäº†ä½¿ç”¨å‘½ä»¤è¡Œå’Œè¯¸å¦‚ `awk`ï¼Œ`sed` å·¥å…·ã€‚ è¿™æ ·çš„å·¥å…·å·²ç»æœ‰æ•ˆåœ°æ ‡å‡†åŒ–äº†å‘½ä»¤è¡Œé€‰é¡¹ï¼ˆåˆåæ ‡å¿—ï¼‰ï¼Œé€‰é¡¹å‚æ•°å’Œå…¶ä»–æ“ä½œçš„è¡Œä¸ºã€‚

é¢„æœŸè¡Œä¸ºçš„ä¸€äº›ç¤ºä¾‹ï¼š

- å¯ä»¥åœ¨å¸®åŠ©æˆ–ç¤ºä¾‹ä¸­å°†é€‰é¡¹å‚æ•°æˆ–é€‰é¡¹æ ‡è®°ä¸ºæ–¹æ‹¬å·ï¼ˆ `[]` ï¼‰è¡¨ç¤ºå®ƒä»¬æ˜¯å¯é€‰çš„ï¼Œæˆ–å¸¦æœ‰å°–æ‹¬å·ï¼ˆ `<>` ï¼‰è¡¨ç¤ºå®ƒä»¬æ˜¯å¿…éœ€çš„ã€‚
- å…è®¸ä½¿ç”¨çŸ­æ ¼å¼çš„å•ä¸ªå­—æ¯å‚æ•°ä½œä¸ºé•¿æ ¼å¼å‚æ•°çš„åˆ«å(è¯·å‚é˜…[GNU ç¼–ç æ ‡å‡†](https://www.gnu.org/prep/standards/html_node/Command_002dLine-Interfaces.html)).
- options specified using the short form singular `-` may contain one alphanumeric character.
- æŒ‡å®šå¤šä¸ªæ²¡æœ‰å€¼çš„é€‰é¡¹å¯ä»¥è¿›è¡Œåˆ†ç»„ï¼Œä¾‹å¦‚ `myCli -abc` ç­‰æ•ˆäº `myCli -a -b -c`ã€‚

å‘½ä»¤è¡Œé«˜çº§ç”¨æˆ·å¸Œæœ›æ‚¨çš„å‘½ä»¤è¡Œåº”ç”¨ç¨‹åºå…·æœ‰ä¸å…¶ä»– Unix åº”ç”¨ç¨‹åºç±»ä¼¼çš„çº¦å®šã€‚

ğŸ“¦ **æ¨èçš„è½¯ä»¶åŒ…**

å¯¹å¼€æº Node.js åŒ…çš„å‚è€ƒï¼š

- [commander](https://github.com/tj/commander.js/blob/master/README_zh-Hans.md)
- [yargs](https://github.com/yargs/yargs)

### 1.2 æ„å»ºå¯Œæœ‰åŒç†å¿ƒçš„ CLI

âœ… **å¯è¡Œ:** å°†å·¥ä½œæµæ”¾ç½®åœ¨é€‚å½“çš„ä½ç½®ï¼Œä»¥å¸®åŠ©ç”¨æˆ·æˆåŠŸä¸ CLI è¿›è¡Œäº¤äº’ï¼Œå¦åˆ™å°†å¯¼è‡´é”™è¯¯å’ŒæŒ«è´¥æ„Ÿã€‚

âŒ **å¦åˆ™:** å¦‚æœä¸èƒ½åœ¨æ”¯æŒç”¨æˆ·æ–¹é¢æä¾›å¯æ“ä½œçš„å¸®åŠ©ï¼Œå°†ä¼šå› ä¸ºç¼ºä¹æ“ä½œ CLI çš„èƒ½åŠ›è€Œå¯¼è‡´å—æŒ«ã€‚

â„¹ï¸ **è¯¦æƒ…**

ä¸€ä¸ªç¨‹åºçš„å‘½ä»¤è¡Œç•Œé¢ä¸ web ç”¨æˆ·ç•Œé¢æ²¡æœ‰ä»€ä¹ˆä¸åŒï¼Œå› ä¸ºæ‚¨å¯ä»¥æŒ‰ç…§ç¨‹åºä½œè€…çš„æ„æ„¿å®Œæˆå°½å¯èƒ½å¤šçš„å·¥ä½œï¼Œä»¥ç¡®ä¿å®ƒè¢«æˆåŠŸåœ°ä½¿ç”¨ã€‚

é€šè¿‡æ„å»ºæ”¯æŒä»£å…¥ç”¨æˆ·æ„Ÿå—çš„ CLI æ¥ä¼˜åŒ–æˆåŠŸçš„äº¤äº’ã€‚ ä½œä¸ºä¸€ä¸ªä¾‹å­ï¼Œè®©æˆ‘ä»¬ç ”ç©¶ä¸€ä¸‹ `curl` ç¨‹åºæœŸæœ› URL ä½œä¸ºå…¶ä¸»è¦æ•°æ®è¾“å…¥ï¼Œè€Œç”¨æˆ·æœªèƒ½æä¾›å®ƒçš„æƒ…å†µã€‚ æ­¤ç±»å¤±è´¥å°†å¯¼è‡´é˜…è¯»ï¼ˆå¸Œæœ›ï¼‰æè¿°æ€§é”™è¯¯æ¶ˆæ¯æˆ–æŸ¥çœ‹ `curl --help` è¾“å‡ºã€‚ ç„¶è€Œï¼Œè€ƒè™‘ç”¨æˆ·æ„Ÿå—çš„ CLI ä¼šå‘ˆç°ä¸€ä¸ªäº¤äº’å¼æç¤ºæ¥æ•è·ç”¨æˆ·çš„è¾“å…¥ï¼Œä»è€Œå®ç°æˆåŠŸçš„äº¤äº’ã€‚

### 1.3 çŠ¶æ€æ•°æ®

âœ… **å¯è¡Œ:** åœ¨ CLI åº”ç”¨ç¨‹åºçš„å¤šæ¬¡è°ƒç”¨ä¹‹é—´æä¾›æœ‰çŠ¶æ€çš„ä½“éªŒï¼Œå¹¶è®°ä½å€¼å’Œæ•°æ®ä»¥æä¾›æ— ç¼äº¤äº’ã€‚

âŒ **å¦åˆ™:** è¦æ±‚æ‚¨çš„ç”¨æˆ·åœ¨å¤šæ¬¡è°ƒç”¨ CLI æ—¶é‡å¤æä¾›ç›¸åŒçš„ä¿¡æ¯ä¼šæƒ¹æ¼æ‚¨çš„ç”¨æˆ·ã€‚

â„¹ï¸ **è¯¦æƒ…**

ä½ å¯èƒ½å‘ç°è‡ªå·±éœ€è¦ä¸ºä½ çš„ CLI åº”ç”¨ç¨‹åºæä¾›å­˜å‚¨æŒä¹…æ€§ã€‚ ä¾‹å¦‚è®°ä½ç”¨æˆ·åã€ç”µå­é‚®ä»¶ã€APIä»¤ç‰Œæˆ–å¤šæ¬¡ä½¿ç”¨ CLI ä¹‹é—´çš„å…¶ä»–é¦–é€‰é¡¹ã€‚ ä½¿ç”¨é…ç½®åŠ©æ‰‹ï¼Œå…è®¸åº”ç”¨ç¨‹åºæŒç»­ä½¿ç”¨æ­¤ç”¨æˆ·è®¾ç½®ã€‚ åœ¨é˜…è¯»/å†™å…¥æ–‡ä»¶æ—¶è¯·åŠ¡å¿…éµå¾ª [XDG åŸºç¡€ç›®å½•è§„æ ¼](https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html) (æˆ–é€‰æ‹©ä¸€ä¸ªå°Šé‡è¯¥æ•°æ®çš„é…ç½®åŠ©ç†)ã€‚ è¿™ä½¿ç”¨æˆ·èƒ½å¤Ÿæ§åˆ¶æ–‡ä»¶çš„ç¼–å†™å’Œç®¡ç†ä½ç½®ã€‚

å‚è€ƒé¡¹ç›®ï¼š

- [configstore](https://www.npmjs.com/package/configstore)
- [conf](https://www.npmjs.com/package/conf)

### 1.4 æä¾›å¯Œæœ‰è‰²å½©çš„ä½“éªŒ

âœ… **å¯è¡Œï¼š** åœ¨ CLI åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨é¢œè‰²æ¥çªå‡ºæ˜¾ç¤ºåº”ç”¨ç¨‹åºè¾“å‡ºçš„éƒ¨åˆ†å†…å®¹ï¼Œå¹¶æä¾›ä¼˜é›…çš„é™çº§æˆ–é¢œè‰²æ£€æµ‹ï¼Œä»¥å…è®¸è‡ªåŠ¨é€€å‡ºï¼Œä»¥å…è¾“å‡ºå‡ºç°ä¹±ç ã€‚ é€šè¿‡ CLI é€‰é¡¹ã€ç¯å¢ƒå˜é‡å’Œ/æˆ–é…ç½®æ–‡ä»¶ç¡®ä¿æ‰‹åŠ¨é€‰å…¥å’Œé€€å‡ºæ˜¯å¯ä»¥çš„ã€‚

âŒ **å¦åˆ™:** è‹ç™½çš„ç¨‹åºè¾“å‡ºä¸­å¯èƒ½å®¹æ˜“ä¸¢å¤±ä¿¡æ¯ï¼Œå°¤å…¶æ˜¯å½“è¾“å‡ºæ–‡æœ¬ç¹é‡çš„æ—¶å€™ã€‚

â„¹ï¸ **è¯¦æƒ…**

å¤§å¤šæ•°ä»Šå¤©ç”¨äºä¸å‘½ä»¤è¡Œåº”ç”¨ç¨‹åºäº¤äº’çš„ç»ˆç«¯æ”¯æŒé¢œè‰²æ–‡æœ¬ï¼Œä¾‹å¦‚ç”±ç‰¹åˆ¶çš„ ANSI ç¼–ç çš„å­—ç¬¦å¼€å¯ã€‚

æ‚¨çš„å‘½ä»¤è¡Œåº”ç”¨ç¨‹åºè¾“å‡ºä¸­çš„å½©è‰²æ˜¾ç¤ºå¯èƒ½ä¼šè¿›ä¸€æ­¥ä¿ƒè¿›æ›´ä¸°å¯Œçš„ä½“éªŒå’Œå¢å¼ºäº’åŠ¨ã€‚ å°½ç®¡å¦‚æ­¤ï¼Œä¸å—æ”¯æŒçš„ç»ˆç«¯å¯èƒ½ä¼šåœ¨å±å¹•ä¸Šä»¥ç´¯èµ˜ä¿¡æ¯çš„å½¢å¼å‡ºç°é€€åŒ–çš„è¾“å‡ºã€‚ æ­¤å¤–ï¼ŒCLI å¯èƒ½è¢«ç”¨äºä¸æ”¯æŒå½©è‰²è¾“å‡ºçš„æŒç»­é›†æˆæ„å»ºä½œä¸šã€‚ å¦‚ä»Šï¼Œå¤§å¤šæ•°ç”¨äºä¸å‘½ä»¤è¡Œåº”ç”¨ç¨‹åºäº¤äº’çš„ç»ˆç«¯éƒ½æ”¯æŒå½©è‰²æ–‡æœ¬ï¼Œä¾‹å¦‚é€šè¿‡ç‰¹åˆ¶ ANSI ç¼–ç å­—ç¬¦å¯ç”¨çš„æ–‡æœ¬ã€‚ å‘½ä»¤è¡Œåº”ç”¨ç¨‹åºè¾“å‡ºä¸­çš„å½©è‰²æ˜¾ç¤ºå¯èƒ½ä¼šè¿›ä¸€æ­¥ä¿ƒè¿›æ›´ä¸°å¯Œçš„ä½“éªŒå’Œæ›´å¤šçš„äº¤äº’ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸å—æ”¯æŒçš„ç»ˆç«¯å¯èƒ½ä¼šç»å†å±å¹•ä¸Šä¹±ç ä¿¡æ¯å½¢å¼çš„è¾“å‡ºé™çº§ã€‚æ­¤å¤–ï¼ŒCLI å¯ä»¥åœ¨å¯èƒ½ä¸æ”¯æŒå½©è‰²è¾“å‡ºçš„æŒç»­é›†æˆæ„å»ºä½œä¸šä¸­ä½¿ç”¨ã€‚å³ä½¿åœ¨æ„å»ºæœåŠ¡å™¨ä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ IDE çš„æ§åˆ¶å°ä½¿ç”¨ CLIï¼Œè¯¥æ§åˆ¶å°å¯èƒ½æ— æ³•å¤„ç†æŸäº›å­—ç¬¦ã€‚å¿…é¡»å¯ä»¥æ‰‹åŠ¨é€‰æ‹©é€€å‡ºã€‚

ğŸ“¦ **æ¨èçš„è½¯ä»¶åŒ…**

å¯¹å¼€æº Node.js åŒ…çš„å‚è€ƒï¼š

- [chalk](https://www.npmjs.com/package/chalk)
- [colors](https://www.npmjs.com/package/colors)
- [kleur](https://www.npmjs.com/package/kleur)

### 1.5 ä¸°å¯Œçš„äº¤äº’

âœ… **å¯è¡Œ:** é™¤äº†æ–‡æœ¬è¾“å…¥æç¤ºç¬¦ä¹‹å¤–ï¼Œè¿˜å¯ä»¥åˆ©ç”¨ä¸°å¯Œçš„å‘½ä»¤è¡Œäº¤äº’ä¸º CLI ç”¨æˆ·æä¾›æ›´æµç•…çš„ä½“éªŒã€‚

âŒ **å¦åˆ™:** å½“æ•°æ®æ˜¯ä»¥å°é—­é€‰é¡¹(å³ä¸‹æ‹‰èœå•)çš„å½¢å¼å‡ºç°æ—¶ï¼Œä½œä¸ºè¾“å…¥çš„æ–‡æœ¬æç¤ºå¯èƒ½å¯¹ç”¨æˆ·æ¥è¯´å¾ˆéº»çƒ¦ã€‚

â„¹ï¸ **è¯¦æƒ…**

ä¸°å¯Œçš„äº¤äº’æ€§å¯ä»¥ä»¥æç¤ºè¾“å…¥çš„å½¢å¼å¼•å…¥ï¼Œæç¤ºè¾“å…¥æ¯”è‡ªç”±æ–‡æœ¬æ›´å¤æ‚ï¼Œä¾‹å¦‚ä¸‹æ‹‰é€‰æ‹©åˆ—è¡¨ã€å•é€‰æŒ‰é’®åˆ‡æ¢ã€è¯„çº§ã€è‡ªåŠ¨å®Œæˆæˆ–éšè—å¯†ç è¾“å…¥ã€‚

ä¸°å¯Œçš„äº¤äº’æ€§çš„å¦ä¸€ç§å½¢å¼æ˜¯åŠ¨ç”»åŠ è½½å™¨å’Œè¿›åº¦æ¡ï¼Œå®ƒä»¬åœ¨æ‰§è¡Œå¼‚æ­¥å·¥ä½œæ—¶ä¸ºç”¨æˆ·æä¾›æ›´å¥½çš„ä½“éªŒã€‚

è®¸å¤š CLI æä¾›é»˜è®¤çš„å‘½ä»¤è¡Œå‚æ•°ï¼Œè€Œæ— éœ€ä»»ä½•è¿›ä¸€æ­¥çš„äº¤äº’ä½“éªŒã€‚ ä¸è¦å¼ºè¿«ä½ çš„ç”¨æˆ·æä¾›åº”ç”¨ç¨‹åºå¯ä»¥è‡ªè¡Œè§£å†³çš„å‚æ•°ã€‚

ğŸ“¦ **æ¨èçš„è½¯ä»¶åŒ…**

å¯¹å¼€æº Node.js åŒ…çš„å‚è€ƒï¼š

- [enquirer](https://www.npmjs.com/package/enquirer)
- [ora](https://www.npmjs.com/package/ora)
- [ink](https://www.npmjs.com/package/ink)
- [prompts](https://www.npmjs.com/package/prompts)

### 1.6 æ— å¤„ä¸åœ¨çš„è¶…é“¾æ¥

âœ… **å¯è¡Œ:** åœ¨æ–‡æœ¬è¾“å‡ºä¸­ä¸ºä¸¤ä¸ª URL ä½¿ç”¨æ ¼å¼æ­£ç¡®çš„è¶…é“¾æ¥ (e.g: `https://www.github.com`), ä»¥åŠæºä»£ç  (e.g: `src/Util.js:2:75`) - ç°ä»£ç»ˆç«¯èƒ½å¤Ÿå°†è¿™ä¸¤è€…è½¬æ¢ä¸ºå¯ç‚¹å‡»çš„é“¾æ¥ã€‚

âŒ **å¦åˆ™:** é¿å…åƒ `git.io/abc` è¿™æ ·éœ€è¦ç”¨æˆ·æ‰‹åŠ¨å¤åˆ¶å’Œç²˜è´´çš„ä¸­æ–­ä¸”éäº¤äº’å¼çš„é“¾æ¥ã€‚

â„¹ï¸ **è¯¦æƒ…**

å¦‚æœæ‚¨åˆ†äº«æŒ‡å‘ URL çš„é“¾æ¥ï¼Œæˆ–è€…æŒ‡å‘æŸä¸ªæ–‡ä»¶ä»¥åŠè¯¥æ–‡ä»¶ä¸­çš„ç‰¹å®šè¡Œå·å’Œåˆ—ï¼Œåˆ™å¯ä»¥æä¾›æŒ‡å‘è¿™ä¸¤ä¸ªç¤ºä¾‹çš„æ ¼å¼æ­£ç¡®çš„é“¾æ¥ï¼Œä¸€æ—¦å•å‡»è¿™äº›é“¾æ¥ï¼Œå°±ä¼šåœ¨æµè§ˆå™¨æˆ– IDE å®šä¹‰çš„ä½ç½®æ‰“å¼€ã€‚

å‚è€ƒé¡¹ç›®ï¼š

- [open](https://github.com/sindresorhus/open)

### 1.7 é›¶é…ç½®

âœ… **å¯è¡Œ:** é€šè¿‡è‡ªåŠ¨æ£€æµ‹æ‰€éœ€çš„é…ç½®å’Œå‘½ä»¤è¡Œå‚æ•°å€¼æ¥ä¼˜åŒ–å³æ’å³ç”¨ä½“éªŒ

âŒ **å¦åˆ™:** å¦‚æœå¯ä»¥ç”¨å¯é çš„æ–¹å¼è‡ªåŠ¨æ£€æµ‹å‘½ä»¤è¡Œå‚æ•°ï¼Œå¹¶ä¸”è°ƒç”¨çš„æ“ä½œä¸æ˜¾å¼è¦æ±‚ç”¨æˆ·äº¤äº’ï¼ˆä¾‹å¦‚ç¡®è®¤åˆ é™¤ï¼‰ï¼Œåˆ™ä¸è¦å¼ºåˆ¶ç”¨æˆ·äº¤äº’ã€‚

â„¹ï¸ **Details**

ç›®çš„æ˜¯åœ¨è¿è¡Œ CLI åº”ç”¨ç¨‹åºæ—¶æä¾›ã€Œå¼€ç®±å³ç”¨ã€çš„ä½“éªŒã€‚ ä¾‹å¦‚ï¼Œ [POSIXå®šä¹‰äº†ç”¨äºä¸åŒç”¨é€”çš„ç¯å¢ƒå˜é‡é…ç½®](https://pubs.opengroup.org/onlinepubs/009695399/basedefs/xbd_chap08.html) çš„æ ‡å‡†ã€‚ ä¾‹å¦‚ï¼š `TMPDIR`, `NO_COLOR`, `DEBUG`, `HTTP_PROXY` å’Œå…¶ä»–ã€‚ è‡ªåŠ¨æ£€æµ‹è¿™äº›å¹¶åœ¨å¿…è¦æ—¶æç¤ºç¡®è®¤ã€‚

å›´ç»•é›¶é…ç½®æ„å»ºçš„å‚è€ƒé¡¹ç›®ï¼š

- [Jest JavaScript æµ‹è¯•æ¡†æ¶](https://jestjs.io)
- [Parcel](https://parceljs.org), Web åº”ç”¨ç¨‹åºæ‰“åŒ…å·¥å…·

### 1.8 éµå®ˆ POSIX ä¿¡å·

âœ… **å¯è¡Œ:** ç¡®ä¿æ‚¨çš„ç¨‹åºéµå®ˆ [POSIX ä¿¡å·](http://man7.org/linux/man-pages/man7/signal.7.html) ä»¥ä½¿å…¶èƒ½å¤Ÿä¸ç”¨æˆ·æˆ–å…¶ä»–ç¨‹åºæ­£ç¡®äº¤äº’ã€‚

âŒ **å¦åˆ™:** æ‚¨çš„ç¨‹åºä¸èƒ½ä¸å…¶ä»–ç¨‹åºå¾ˆå¥½åœ°é…åˆï¼Œå¹¶ä¼šå¼•å…¥æ„å¤–çš„è¡Œä¸ºã€‚

â„¹ï¸ **è¯¦æƒ…**

å°¤å…¶æ˜¯å¯¹äº CLI åº”ç”¨ç¨‹åºï¼Œä¸ç”¨æˆ·è¾“å…¥äº¤äº’æ˜¯å¾ˆå¸¸è§çš„ï¼Œå¦‚æœç®¡ç†ä¸å½“ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ‚¨çš„åº”ç”¨ç¨‹åºæ— æ³•å“åº” SIGINT ä¸­æ–­ï¼Œç”¨æˆ·åœ¨æŒ‰ä¸‹ `CTRL+C` é”®æ—¶é€šå¸¸ä¼šä½¿ç”¨ SIGINT ä¸­æ–­ã€‚

ä¸éµå®ˆè¿›ç¨‹ä¿¡å·çš„é—®é¢˜åœ¨ç”±éäººä¹‹é—´çš„äº’åŠ¨å¼•å¯¼ä¸‹æ¥æ—¶æ›´åŠ ä¸¥é‡ã€‚ ä¾‹å¦‚ï¼Œåœ¨ Docker å®¹å™¨ä¸­è¿è¡Œä½†ä¸ä¼šå“åº”å‘é€ç»™å®ƒçš„è½¯ä»¶ä¸­æ–­ä¿¡å·çš„ CLIã€‚

# 2 åˆ†å‘

æœ¬èŠ‚ä»‹ç»äº†æœ‰å…³ä»¥æœ€ä½³æ–¹å¼åˆ†å‘å’Œæ‰“åŒ… Node.js å‘½ä»¤è¡Œåº”ç”¨ç¨‹åºçš„æœ€ä½³å®è·µï¼Œä¾›æ¶ˆè´¹è€…ä½¿ç”¨ã€‚

åœ¨æœ¬èŠ‚ä¸­ï¼š

- 2.1 [é€‰æ‹©å ç”¨è¾ƒå°çš„ä¾èµ–é¡¹](#21-%E9%80%89%E6%8B%A9%E5%8D%A0%E7%94%A8%E8%BE%83%E5%B0%8F%E7%9A%84%E4%BE%9D%E8%B5%96%E9%A1%B9)
- 2.2 [ä½¿ç”¨ shrinkwrap, Luke](#22-%E4%BD%BF%E7%94%A8shrinkwrap,-Luke)
- 2.3 [æ¸…ç†é…ç½®æ–‡ä»¶](#23-æ¸…ç†é…ç½®æ–‡ä»¶)

### 2.1 é€‰æ‹©å ç”¨è¾ƒå°çš„ä¾èµ–é¡¹

âœ… **å¯è¡Œ:** æœ€å¤§é™åº¦åœ°å‡å°‘ç”Ÿäº§ä¾èµ–é¡¹çš„ä½¿ç”¨ï¼Œä½¿ç”¨è¾ƒå°çš„æ›¿ä»£ä¾èµ–é¡¹ï¼Œå¹¶å®¡æŸ¥ä¾èµ–é¡¹çš„è¦†ç›–èŒƒå›´ä»¥åŠä¼ é€’æ€§ä¾èµ–é¡¹ï¼Œä»¥ç¡®ä¿ Node.js CLI çš„å°æ†ç»‘ã€‚ åœ¨è¿™ä¸ªé—®é¢˜ä¸Šä¿æŒå¹³è¡¡ï¼Œæ³¨æ„ä¸è¦é€šè¿‡é‡å¼€è½®æ¥è¿‡åº¦ä¼˜åŒ–å¯¹ä¾èµ–çš„ä½¿ç”¨ã€‚

âŒ **å¦åˆ™:** åº”ç”¨ç¨‹åºä¸­ä¾èµ–é¡¹çš„å¤§å°å’Œä½¿ç”¨å°†å½±å“ Node.js CLI çš„å®‰è£…æ—¶é—´ï¼Œä»è€Œæ½œåœ¨åœ°æä¾›ç³Ÿç³•çš„ç”¨æˆ·ä½“éªŒã€‚

â„¹ï¸ **è¯¦æƒ…**

ä½¿ç”¨ `npx` è°ƒç”¨çš„ Node.js CLI çš„å¿«é€Ÿ `npm install` å°†æä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒã€‚ å½“æ€»ä½“ä¾èµ–å…³ç³»å’Œä¼ é€’ä¾èµ–å…³ç³»å°†å ç”¨ç©ºé—´ä¿æŒåœ¨åˆç†å¤§å°æ—¶ï¼Œå°±å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚

ä¸€æ¬¡å®‰è£…å…¨å±€ `npm` ç¼“æ…¢å®‰è£…çš„ `npm` è½¯ä»¶åŒ…å°†æä¾›ä¸€æ¬¡çš„ç³Ÿç³•ä½“éªŒï¼Œä½†æ˜¯ï¼Œç”¨æˆ·ä½¿ç”¨ `npx` è°ƒç”¨å¯æ‰§è¡ŒåŒ…ä¼šä½¿æ€§èƒ½ä¸‹é™ï¼Œå› ä¸º `npx` æ€»æ˜¯ä»æ³¨å†Œè¡¨è·å–å’Œå®‰è£…åŒ…ï¼Œè¿™ä¸€ç‚¹æ›´åŠ æ˜¾è‘—å’Œæ˜æ˜¾ã€‚

å‚è€ƒé¡¹ç›®ï¼š

- [Bundlephobia](https://bundlephobia.com/) æ˜¯å¸®åŠ©æ‚¨æ‰¾åˆ°ä¸€ä¸ª npm è½¯ä»¶åŒ…çš„æˆæœ¬ã€‚

### 2.2 ä½¿ç”¨ shrinkwrap, Luke

âœ… **å¯è¡Œ:** å°† npm çš„ `npm-shrinkwrap.json` ç”¨ä½œé”å®šæ–‡ä»¶ï¼Œä»¥ç¡®ä¿æœ€ç»ˆç”¨æˆ·åœ¨å®‰è£… npm è½¯ä»¶åŒ…æ—¶å°†å›ºå®šçš„ä¾èµ–é¡¹ç‰ˆæœ¬ï¼ˆç›´æ¥å’Œä¼ é€’ï¼‰ä¼ æ’­ç»™æœ€ç»ˆç”¨æˆ·ã€‚

âŒ **å¦åˆ™:** ä¸ä¿®å¤åº”ç”¨ä¾èµ–é¡¹çš„ç‰ˆæœ¬å°†æ„å‘³ç€åŒ…ç®¡ç†å™¨ï¼ˆä¾‹å¦‚ `npm`ï¼‰å°†åœ¨å®‰è£…æœŸé—´è§£æå®ƒä»¬ï¼Œé€šè¿‡ç‰ˆæœ¬èŒƒå›´å®‰è£…çš„å¯ä¼ é€’ä¾èµ–é¡¹å¯èƒ½ä¼šå¼•å…¥æ‚¨æ— æ³•æ§åˆ¶çš„ç ´åæ€§æ›´æ”¹ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´æ‚¨çš„ Node.js CLI åº”ç”¨ç¨‹åºæ— æ³•æ„å»ºæˆ–è¿è¡Œã€‚

â„¹ï¸ **è¯¦æƒ…**

ä½¿ç”¨ ~~ force ~~ shrinkwrap, Luke!

é€šå¸¸ï¼Œnpm åŒ…åœ¨å®‰è£…æ—¶åªå®šä¹‰å…¶ç›´æ¥ä¾èµ–é¡¹åŠå…¶ç‰ˆæœ¬èŒƒå›´ï¼Œå¹¶ä¸” Npm åŒ…ç®¡ç†å™¨å°†åœ¨å®‰è£…æ—¶è§£ææ‰€æœ‰å¯ä¼ é€’ä¾èµ–é¡¹çš„ç‰ˆæœ¬ã€‚ éšç€æ—¶é—´çš„æ¨ç§»ï¼Œä¾èµ–é¡¹çš„è§£æç‰ˆæœ¬ä¼šæœ‰æ‰€ä¸åŒï¼Œå› ä¸ºæ–°çš„ç›´æ¥ä¾èµ–é¡¹å’Œä¼ é€’ä¾èµ–é¡¹å°†å‘å¸ƒæ–°ç‰ˆæœ¬ã€‚

å°½ç®¡ [è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶](https://semver.org/) åœ¨ç»´æŠ¤äººå‘˜ä¸­è¢«å¹¿æ³›æ¥å—ï¼Œä½†å·²çŸ¥ npm ä¼šä¸ºæ­£åœ¨å®‰è£…çš„æ™®é€šè½¯ä»¶åŒ… [å¼•å…¥è®¸å¤šä¾èµ–é¡¹](https://snyk.io/blog/how-much-do-we-really-know-about-how-packages-behave-on-the-npm-registry/)ï¼Œè¿™å¢åŠ äº†è½¯ä»¶åŒ…å¼•å…¥å¯èƒ½ä¼šç ´ååº”ç”¨ç¨‹åºçš„æ›´æ”¹çš„é£é™©ã€‚

ä½¿ç”¨ `npm-shrinkwrap.json` çš„å¦ä¸€æ–¹é¢æ˜¯æ‚¨å¼ºåŠ ç»™æ‚¨çš„æ¶ˆè´¹è€…çš„å®‰å…¨éšæ‚£ã€‚æ­£åœ¨å®‰è£…çš„ä¾èµ–é¡¹è¢«å›ºå®šåˆ°ç‰¹å®šç‰ˆæœ¬ï¼Œå› æ­¤å³ä½¿å‘å¸ƒäº†è¿™äº›ä¾èµ–é¡¹çš„è¾ƒæ–°ç‰ˆæœ¬ï¼Œä¹Ÿä¸ä¼šå®‰è£…å®ƒä»¬ã€‚è¿™å°†ä½¿æ‚¨ï¼ˆç»´æŠ¤äººå‘˜ï¼‰æœ‰è´£ä»»ä¿æŒå¯¹ä¾èµ–é¡¹ä¸­ä»»ä½•å®‰å…¨ä¿®å¤ç¨‹åºçš„æœ€æ–°äº†è§£ï¼Œå¹¶é€šè¿‡å®‰å…¨æ›´æ–°å®šæœŸå‘å¸ƒ CLI åº”ç”¨ç¨‹åºã€‚è€ƒè™‘ä½¿ç”¨ [Snyk ä¾èµ–å‡çº§](https://snyk.io/) åœ¨æ•´ä¸ªä¾èµ–å…³ç³»æ ‘ä¸­è‡ªåŠ¨è§£å†³å®‰å…¨é—®é¢˜ã€‚_å…¨é¢æŠ«éœ²ï¼šæˆ‘æ˜¯ Snyk çš„å¼€å‘è€…å€¡å¯¼è€…ã€‚_ æ­£åœ¨å®‰è£…çš„ä¾èµ–å…³ç³»è¢«å›ºå®šåˆ°ç‰¹å®šçš„ç‰ˆæœ¬ï¼Œæ‰€ä»¥å³ä½¿è¿™äº›ä¾èµ–çš„æ›´æ–°ç‰ˆæœ¬è¢«å‘å¸ƒï¼Œå®ƒä»¬ä¹Ÿä¸ä¼šè¢«å®‰è£…ã€‚ è¿™ä½¿å¾—ä½ è¿™ä½ç»´æŠ¤è€…è´Ÿè´£éšæ—¶æ›´æ–°ä½ ä¾èµ–çš„ä»»ä½•å®‰å…¨ä¿®å¤ã€‚ å¹¶å®šæœŸå‘å¸ƒæ‚¨çš„ CLI åº”ç”¨ï¼Œå¹¶å¸¦æœ‰å®‰å…¨æ›´æ–°ã€‚ è€ƒè™‘ä½¿ç”¨ [Snyk ä¾èµ–å…³ç³»å‡çº§](https://snyk.io/) æ¥è‡ªåŠ¨ä¿®å¤ä¾èµ–æ ‘çš„å®‰å…¨é—®é¢˜ã€‚ _å®Œå…¨å…¬å¼€ï¼šæˆ‘æ˜¯Snykçš„å¼€å‘è€…æå€¡è€…_

> ğŸ‘ æç¤º
> 
> ä½¿ç”¨ `npm shrinkwrap` å‘½ä»¤ç”Ÿæˆ shrinkwrap é”å®šæ–‡ä»¶ï¼Œå…¶æ ¼å¼ä¸`package-lock.json`æ–‡ä»¶çš„æ ¼å¼ç›¸åŒã€‚

å‚è€ƒæ–‡çŒ®ï¼š

- [æ‚¨çœŸçš„çŸ¥é“é”æ–‡ä»¶å¦‚ä½•å¤„ç† yarn å’Œ npm è½¯ä»¶åŒ…å—ï¼Ÿ](https://snyk.io/blog/making-sense-of-package-lock-files-in-the-npm-ecosystem/)
- [Yarn æ–‡æ¡£ï¼šåº”è¯¥å°†é”å®šæ–‡ä»¶æäº¤åˆ°å­˜å‚¨åº“å—ï¼Ÿ](https://next.yarnpkg.com/advanced/qa#should-lockfiles-be-committed-to-the-repository)

### 2.3 æ¸…ç†é…ç½®æ–‡ä»¶

âœ… **å¯è¡Œ:** å¸è½½ CLI åº”ç”¨ç¨‹åºæ—¶æ¸…ç†é…ç½®æ–‡ä»¶ã€‚ï¼ˆå¯é€‰ï¼‰CLI åº”ç”¨ç¨‹åºå¯ä»¥æç¤ºæ‚¨çš„ç”¨æˆ·ä¿ç•™é…ç½®æ–‡ä»¶ï¼Œä»¥è·³è¿‡ä¸‹ä¸€æ¬¡å®‰è£…æ—¶çš„é‡æ–°åˆå§‹åŒ–é˜¶æ®µï¼Œä»è€Œè·å¾—æ›´å¥½çš„ç”¨æˆ·ä½“éªŒã€‚ å¯é€‰ï¼š CLI åº”ç”¨ç¨‹åºå¯ä»¥ä¿ƒä½¿æ‚¨çš„ç”¨æˆ·ä¿ç•™é…ç½®æ–‡ä»¶ä»¥è·³è¿‡ä¸‹æ¬¡å®‰è£…æ—¶çš„é‡æ–°åˆå§‹åŒ–é˜¶æ®µä»¥è·å¾—æ›´å¥½çš„ç”¨æˆ·ä½“éªŒã€‚

âŒ **å¦åˆ™:** ç”¨æˆ·çš„æ–‡ä»¶ç³»ç»Ÿå¯èƒ½åŒ…å«å•ç‹¬é…ç½®æ–‡ä»¶å½¢å¼çš„æ®‹ç•™ç‰©ï¼Œä»¥åŠ CLI å·¥å…·åœ¨å®‰è£…æ—¶å¼•å…¥çš„å¯è¯†åˆ«æ•°æ®ã€‚

â„¹ï¸ **è¯¦æƒ…**

å¦‚ [æœ‰çŠ¶æ€æ•°æ®éƒ¨åˆ†](#13-%E6%9C%89%E7%8A%B6%E6%80%81%E6%95%B0%E6%8D%AE) æ‰€è¿°ï¼Œå¦‚æœæ‚¨çš„ CLI åº”ç”¨ç¨‹åºä½¿ç”¨æŒä¹…æ€§å­˜å‚¨ï¼ˆä¾‹å¦‚ä¿å­˜é…ç½®æ–‡ä»¶ï¼‰ï¼Œåˆ™ CLI åº”ç”¨ç¨‹åºè¿˜åº”è´Ÿè´£åœ¨å¸è½½æ—¶åˆ é™¤å…¶é…ç½®æ–‡ä»¶ã€‚

ç”±äºnpm è½¯ä»¶åŒ…ç®¡ç†å™¨ä¸æä¾›å¸è½½é’©å­ï¼Œå› ä¸ºnpm v7ï¼Œ æ‚¨çš„ç¨‹åºåº”è¯¥åŒ…å«ä¸€ä¸ªå¸è½½é€‰é¡¹ï¼Œè¦ä¹ˆé€šè¿‡ [å‚æ•°](#11-respect-posix-args) (e). ã€‚ `--uninstall`æˆ–é€šè¿‡ [ä¸°å¯Œçš„äº¤äº’](#15-rich-interactions)ã€‚

> ğŸ‘ æç¤º
> 
> ä¸ºæ­¤ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ NPM çš„ pre æˆ– post å¸è½½ [è„šæœ¬](https://docs.npmjs.com/misc/scripts)ã€‚æ‚¨å¯ä»¥åœ¨æ­¤ [å­˜å‚¨åº“](https://github.com/m-sureshraj/jenni/blob/master/src/scripts/pre-uninstall.js) ä¸­æ‰¾åˆ°ä¸€ä¸ªæœ‰æ•ˆçš„ç¤ºä¾‹ã€‚ æ‚¨å¯ä»¥åœ¨æ­¤ [ä»“åº“](https://github.com/m-sureshraj/jenni/blob/master/src/scripts/pre-uninstall.js) ä¸­æ‰¾åˆ°ä¸€ä¸ªå¯ç”¨ç¤ºä¾‹ã€‚

# 3 äº’é€šæ€§

æœ¬èŠ‚ä»‹ç»ä¸ä½¿ Node.js CLI ä¸å…¶ä»–å‘½ä»¤è¡Œå·¥å…·æ— ç¼é›†æˆæœ‰å…³çš„æœ€ä½³å®è·µï¼Œå¹¶éµå¾ª CLI å¯ä»¥æ­£å¸¸è¿è¡Œçš„çº¦å®šã€‚

æœ¬èŠ‚å›ç­”ä»¥ä¸‹é—®é¢˜ï¼š

- _æˆ‘å¯ä»¥å¯¼å‡ºæ­¤ CLI çš„è¾“å‡ºä»¥ä¾¿äºåˆ†æå—ï¼Ÿ_
- _æˆ‘å¯ä»¥å°†æ­¤ CLI çš„è¾“å‡ºé€šè¿‡ç®¡é“ä¼ é€’åˆ°å¦ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·çš„è¾“å…¥å—ï¼Ÿ_
- _æˆ‘å¯ä»¥é€šè¿‡ç®¡é“å°†å…¶ä»–å·¥å…·çš„ç»“æœå‘é€åˆ°æ­¤ CLI å—ï¼Ÿ_

åœ¨æœ¬èŠ‚ä¸­ï¼š

- 3.1 [æ¥å— STDIN è¾“å…¥](#31-%E6%8E%A5%E5%8F%97STDIN%E8%BE%93%E5%85%A5)
- 3.2 [å¯ç”¨ç»“æ„åŒ–è¾“å‡º](#32-%E5%90%AF%E7%94%A8%E7%BB%93%E6%9E%84%E5%8C%96%E8%BE%93%E5%87%BA)
- 3.3 [è·¨å¹³å°è§„èŒƒ](#33-%E8%B7%A8%E5%B9%B3%E5%8F%B0%E8%A7%84%E8%8C%83)
- 3.4 [æ”¯æŒé…ç½®ä¼˜å…ˆ](#34-æ”¯æŒé…ç½®ä¼˜å…ˆ)

### 3.1 æ¥å— STDIN è¾“å…¥

âœ… **å¯è¡Œ:** å¯¹äºé¢„æœŸä½¿ç”¨æ•°æ®çš„å‘½ä»¤è¡Œåº”ç”¨ç¨‹åºï¼Œä½¿ç”¨æˆ·å¯ä»¥è½»æ¾åœ°å°†æ•°æ®é€šè¿‡ç®¡é“ä¼ è¾“åˆ°æ ‡å‡†è¾“å…¥ (STDIN)ã€‚

âŒ **å¦åˆ™:** å…¶ä»–å‘½ä»¤è¡Œåº”ç”¨ç¨‹åºå°†æ— æ³•ç›´æ¥å°†å…¶ç»“æœä½œä¸ºè¾“å…¥æä¾›ç»™æ‚¨çš„ CLIï¼Œè¿™ä¼šé˜»æ­¢å¸¸è§çš„ UNIX å•è¡Œç¨‹åºï¼Œä¾‹å¦‚ï¼š

```sh
$ curl -s "https://api.example.com/data.json" | your_node_cli
```

â„¹ï¸ **è¯¦æƒ…**

å¦‚æœå‘½ä»¤è¡Œåº”ç”¨ç¨‹åºä½¿ç”¨æ•°æ®ï¼Œæ¯”å¦‚å¯¹é€šå¸¸ä½¿ç”¨ `--file<file.json>` å‘½ä»¤è¡Œå‚æ•°æŒ‡å®šçš„ JSON æ–‡ä»¶æ‰§è¡ŒæŸç§ä»»åŠ¡ã€‚

ä¸‹é¢æ˜¯ä¸€ä¸ªåŸºäºå®˜æ–¹ [Node.js API æ–‡æ¡£çš„ readline æ¨¡å—](https://nodejs.org/api/readline.html) ç¤ºä¾‹ï¼Œè¯¥ç¤ºä¾‹è¯´æ˜å¦‚ä½•ä»å‘½ä»¤ç®¡é“è·å–è¾“å…¥ï¼š

```js
const readline = require("readline");

const rl = readline.createInterface({
  input: process.stdin,
  output: process.stdout,
});

rl.question("What do you think of Node.js? ", (answer) => {
  // TODO: Log the answer in a database
  console.log(`Thank you for your valuable feedback: ${answer}`);

  rl.close();
});
```

ç„¶åå°†è¾“å…¥é€šè¿‡ç®¡é“ä¼ é€’åˆ°ä¸Šè¿° Node.js åº”ç”¨ç¨‹åºï¼š

```sh
echo "Node.js is amazing" | node cli.js
```

### 3.2 å¯ç”¨ç»“æ„åŒ–è¾“å‡º

âœ… **å¯è¡Œ:** å¯ç”¨ä¸€ä¸ªæ ‡å¿—ä»¥å…è®¸ç»“æ„åŒ–è¾“å‡ºåº”ç”¨ç¨‹åºçš„ç»“æœï¼ˆå¦‚æœæ­¤ç±»ç»“æœå¯ç”¨ï¼‰ï¼Œä»¥å¯ç”¨æ•°æ®çš„è§£æå’Œè½»æ¾æ“ä½œã€‚

âŒ **å¦åˆ™:** CLI çš„ç”¨æˆ·å¯èƒ½éœ€è¦åº”ç”¨å¤æ‚çš„æ­£åˆ™è¡¨è¾¾å¼è§£æå’ŒåŒ¹é…æŠ€æœ¯æ¥æå– CLI æä¾›çš„è¾“å‡ºæ•°æ®ã€‚

â„¹ï¸ **è¯¦æƒ…**

å¯¹äºå‘½ä»¤è¡Œåº”ç”¨ç¨‹åºçš„ç”¨æˆ·æ¥è¯´ï¼Œè§£ææ•°æ®å¹¶æ‰§è¡Œæ•°æ®é€šå¸¸éå¸¸æœ‰ç”¨ï¼Œä¾‹å¦‚ä½¿ç”¨å®ƒæ¥å¡«å…… Web ä»ªè¡¨æ¿æˆ–ç”µå­é‚®ä»¶é€šçŸ¥ã€‚

èƒ½å¤Ÿè½»æ¾åœ°ä»å‘½ä»¤è¡Œè¾“å‡ºä¸­æå–æ„Ÿå…´è¶£çš„æ•°æ®ï¼Œä¸º CLI ç”¨æˆ·æä¾›äº†æ›´å‹å¥½çš„ä½“éªŒã€‚

### 3.3 è·¨å¹³å°è§„èŒƒ

âœ… **å¯è¡Œ:** å¦‚æœå¸Œæœ› CLI åœ¨è·¨å¹³å°ä¸Šè¿è¡Œï¼Œåˆ™å¿…é¡»é€‚å½“æ³¨æ„ shell å‘½ä»¤ä»¥åŠè¯¸å¦‚æ–‡ä»¶ç³»ç»Ÿä¹‹ç±»çš„ç»„ä»¶ï¼Œä»¥åŠåˆ©ç”¨ç›¸å…³ç¼–ç¨‹æ„é€ çš„å¼€å‘äººå‘˜ã€‚

âŒ **å¦åˆ™:** å³ä½¿ä»£ç ä¸­æ²¡æœ‰åŠŸèƒ½å·®å¼‚ï¼Œç”±äºè¯¸å¦‚è·¯å¾„åˆ†éš”ç¬¦é”™è¯¯ç­‰å› ç´ ï¼ŒCLI åœ¨å…¶ä»–æ“ä½œç³»ç»Ÿä¸Šä¹Ÿä¼šä¸­æ–­ã€‚

â„¹ï¸ **è¯¦æƒ…**

å³ä½¿ä»ç¨‹åºçš„è§’åº¦æ¥çœ‹ï¼Œè¯¥åŠŸèƒ½å¹¶æ²¡æœ‰è¢«å‰¥ç¦»ï¼Œå¹¶ä¸”*åº”è¯¥*åœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿä¸­å¾ˆå¥½åœ°æ‰§è¡Œï¼Œä½†æ˜¯æŸäº›ç»†å¾®çš„å·®åˆ«å¯èƒ½ä¼šä½¿ç¨‹åºæ— æ³•è¿è¡Œã€‚è®©æˆ‘ä»¬æ¢è®¨å¿…é¡»éµå®ˆè·¨å¹³å°è§„èŒƒçš„å‡ ç§æƒ…å†µã€‚ è®©æˆ‘ä»¬æ¢è®¨å¿…é¡»éµå®ˆè·¨å¹³å°è¡Œä¸ºå‡†åˆ™çš„å‡ ä¸ªæ¡ˆä¾‹ã€‚

#### é”™è¯¯åœ°äº§ç”Ÿå‘½ä»¤

æ‚¨å¯èƒ½éœ€è¦ç”Ÿæˆä¸€ä¸ªè¿è¡Œ Node.js ç¨‹åºçš„è¿›ç¨‹ã€‚ ä¾‹å¦‚ï¼Œæ‚¨å…·æœ‰ä»¥ä¸‹è„šæœ¬ï¼š

`program.js`

```js
#!/usr/bin/env node

// the rest of your app code
```

è¿™æœ‰æ•ˆï¼š

```
const cliExecPath = 'program.js'
const process = childProcess.spawn(cliExecPath, [])
```

è¿™ä¸ªæ›´å¥½ï¼š

```
const cliExecPath = 'program.js'
const process = childProcess.spawn('node', [cliExecPath])
```

ä¸ºä»€ä¹ˆè¿™æ ·æ›´å¥½ï¼Ÿ ä¸ºä»€ä¹ˆä¼šæ›´å¥½ï¼Ÿ`program.js` æºä»£ç ä»¥ç±» Unix çš„ [Shebang](https://en.wikipedia.org/wiki/Shebang_(Unix)) ç¬¦å·å¼€å¤´ï¼Œä½†æ˜¯ Windows å¹¶ä¸çŸ¥é“å¦‚ä½•è§£é‡Šè¿™ä¸€ç‚¹ï¼Œå› ä¸º Shebang ä¸æ˜¯è·¨å¹³å°æ ‡å‡†ã€‚

å¯¹äº `package.json` è„šæœ¬ä¹Ÿæ˜¯å¦‚æ­¤ã€‚è€ƒè™‘ä»¥ä¸‹å®šä¹‰ npm è¿è¡Œè„šæœ¬çš„ä¸è‰¯åšæ³•ï¼š è¯·å‚è€ƒå®šä¹‰npm è¿è¡Œè„šæœ¬çš„ä»¥ä¸‹é”™è¯¯ç»ƒä¹ ï¼š

```
"scripts": {
  "postinstall": "myInstall.js"
}
```

è¿™æ˜¯ç”±äº `myInstalls.js` ä¸­çš„ Shebang æ— æ³•å¸®åŠ© Windows äº†è§£å¦‚ä½•ä½¿ç”¨ `node` è§£é‡Šå™¨æ¥è¿è¡Œå®ƒçš„äº‹å®ã€‚

ç›¸åï¼Œè¯·éµå¾ªä»¥ä¸‹æœ€ä½³åšæ³•ï¼š

```
"scripts": {
  "postinstall": "node myInstall.js"
}
```

#### Shell è§£é‡Šå™¨å„æœ‰åƒç§‹

åœ¨ä¸åŒçš„ shell è§£é‡Šç¨‹åºä¸­ï¼Œå¹¶éæ‰€æœ‰å­—ç¬¦éƒ½è¢«è§†ä¸ºç›¸åŒã€‚

ä¾‹å¦‚ï¼ŒWindows å‘½ä»¤æç¤ºç¬¦ä¸ä¼šåƒåœ¨ bash shell ä¸Šæ‰€æœŸæœ›çš„é‚£æ ·å°†å•å¼•å·ä¸åŒå¼•å·ç›¸åŒï¼Œå› æ­¤å®ƒæ— æ³•è¯†åˆ«å•å¼•å·å†…çš„æ•´ä¸ªå­—ç¬¦ä¸²å±äºåŒä¸€å­—ç¬¦ä¸²ç»„ï¼Œè¿™å°†å¯¼è‡´é”™è¯¯ã€‚

åœ¨ä½¿ç”¨ Windows å‘½ä»¤æç¤ºç¬¦çš„ Windows Node.js ç¯å¢ƒä¸­ï¼Œè¯¥æ“ä½œå°†å¤±è´¥ï¼š

package.json

```
"scripts": {
  "format": "prettier-standard '**/*.js'",
  ...
}
```

è¦è§£å†³æ­¤é—®é¢˜ï¼Œä»¥ä¾¿æ­¤ `npm run` è„šæœ¬ç¡®å®å¯ä»¥åœ¨ Windowsï¼ŒmacOS å’Œ Linux ä¹‹é—´è·¨å¹³å°è¿è¡Œï¼š

package.json

```
"scripts": {
  "format": "prettier-standard \"**/*.js\"",
  ...
}
```

åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨åŒå¼•å·ï¼Œå¹¶ä½¿ç”¨ JSON è¡¨ç¤ºç¬¦å¯¹å…¶è¿›è¡Œè½¬ä¹‰ã€‚

#### é¿å…æ‹¼æ¥è·¯å¾„

è·¨ä¸åŒå¹³å°çš„è·¯å¾„æ„é€ æˆªç„¶ä¸åŒã€‚å½“é€šè¿‡æ‹¼æ¥å­—ç¬¦ä¸²æ‰‹åŠ¨æ„å»ºå®ƒä»¬æ—¶ï¼Œå®ƒä»¬å¿…ç„¶åœ¨ä¸åŒå¹³å°ä¹‹é—´ä¸èƒ½äº’ç›¸æ“ä½œã€‚ å½“å®ƒä»¬é€šè¿‡è¿æ¥å­—ç¬¦ä¸²æ‰‹åŠ¨æ„å»ºæ—¶ï¼Œå®ƒä»¬æ³¨å®šä¸èƒ½åœ¨ä¸åŒå¹³å°ä¹‹é—´è¿›è¡Œäº’æ“ä½œã€‚

è®©æˆ‘ä»¬æ€è€ƒä»¥ä¸‹ä¸è‰¯åšæ³•ç¤ºä¾‹ï¼š

```js
const myPath = `${__dirname}/../bin/myBin.js`;
```

å‡å®šæ­£æ–œæ æ˜¯è·¯å¾„åˆ†éš”ç¬¦ï¼Œä¾‹å¦‚åœ¨ Windows ä¸Šä½¿ç”¨åæ–œæ ã€‚

ä¸å…¶æ‰‹åŠ¨æ„å»ºæ–‡ä»¶ç³»ç»Ÿè·¯å¾„ï¼Œä¸å¦‚ä½¿ç”¨ Node.js è‡ªå·±çš„ `path` æ¨¡å—æ¥æ‰§è¡Œæ­¤æ“ä½œï¼š

```js
const myPath = path.join(__dirname, "..", "bin", "myBin.js");
```

#### é¿å…ç”¨åˆ†å·é“¾æ¥å‘½ä»¤

ä¼—æ‰€å‘¨çŸ¥ï¼ŒLinux shell æ”¯æŒåˆ†å· (`;`) æ¥é“¾æ¥å‘½ä»¤ä»¥æŒ‰é¡ºåºè¿è¡Œï¼Œä¾‹å¦‚ï¼š`cd/tmp;ls`ã€‚ä½†æ˜¯ï¼Œåœ¨ Windows ä¸Šæ‰§è¡Œç›¸åŒçš„æ“ä½œå°†å¤±è´¥ã€‚ ç„¶è€Œï¼Œåœ¨Windowsä¸ŠåšåŒæ ·çš„æ“ä½œä¹Ÿä¼šå¤±è´¥ã€‚

é¿å…æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

```js
const process = childProcess.exec(`${cliExecPath}; ${cliExecPath2}`);
```

è€Œæ˜¯ä½¿ç”¨ã€Œ&&ã€å·æˆ–ã€Œ||ã€ç¬¦å·ï¼š

```js
const process = childProcess.exec(`${cliExecPath} || ${cliExecPath2}`);
```

### 3.4 æ”¯æŒé…ç½®ä¼˜å…ˆ

âœ… **å¯è¡Œ:** å…è®¸æŒ‰ä¼˜å…ˆé¡ºåºä»å¤šä¸ªæ¥æºè·å–é…ç½®ã€‚  å‘½ä»¤è¡Œå‚æ•°å…·æœ‰æœ€é«˜ä¼˜å…ˆçº§ï¼Œå…¶æ¬¡æ˜¯ shell å˜é‡ï¼Œç„¶åæ˜¯ä¸åŒçº§åˆ«çš„é…ç½®ã€‚

âŒ **å¦åˆ™:** ç”¨æˆ·åœ¨ä½¿ç”¨ CLI è‡ªå®šä¹‰ä½“éªŒæ—¶ä¼šæœ‰æŒ«æŠ˜æ„Ÿã€‚

â„¹ï¸ **è¯¦æƒ…**

ä½¿ç”¨ç¯å¢ƒå˜é‡æ£€æµ‹å’Œæ”¯æŒé…ç½®è®¾ç½®ï¼Œå› ä¸ºè¿™å°†æ˜¯è®¸å¤šå·¥å…·é“¾ä¸­å¸¸è§çš„æ–¹æ³•æ¥ä¿®æ”¹è¢«å¼•ç”¨çš„ CLI åº”ç”¨ç¨‹åºçš„è¡Œä¸ºã€‚

å‘½ä»¤è¡Œåº”ç”¨ç¨‹åºçš„é…ç½®ä¼˜å…ˆé¡ºåºåº”éµå¾ªä»¥ä¸‹è§„åˆ™ï¼š

- è°ƒç”¨åº”ç”¨ç¨‹åºæ—¶æŒ‡å®šçš„å‘½ä»¤è¡Œå‚æ•°ã€‚
- ç”Ÿæˆ shell çš„ç¯å¢ƒå˜é‡å’Œåº”ç”¨ç¨‹åºå¯ç”¨çš„ä»»ä½•å…¶ä»–ç¯å¢ƒå˜é‡ã€‚
- é¡¹ç›®èŒƒå›´é…ç½®ï¼Œä¾‹å¦‚ï¼šæœ¬åœ°ç›®å½• `.git/config` æ–‡ä»¶ã€‚
- ç”¨æˆ·èŒƒå›´é…ç½®ï¼Œä¾‹å¦‚ï¼šç”¨æˆ·çš„ä¸»ç›®å½•é…ç½®æ–‡ä»¶ï¼š`~/.gitconfig` æˆ–å…¶ XDG ç­‰æ•ˆæ–‡ä»¶ï¼š`~/.config/git/config`ã€‚
- ç³»ç»ŸèŒƒå›´é…ç½®ï¼Œä¾‹å¦‚ï¼š`/etc/gitconfig`ã€‚

å‚è€ƒé¡¹ç›®ï¼š

- [cosmiconfig](https://github.com/davidtheclark/cosmiconfig)

# 4 è¾…åŠ©åŠŸèƒ½

æœ¬èŠ‚ä»‹ç»ä¸æœ€ä½³å®è·µæœ‰å…³çš„å†…å®¹ï¼Œè¿™äº›æœ€ä½³å®è·µæ˜¯å°† Node.js CLI åº”ç”¨ç¨‹åºæä¾›ç»™å¸Œæœ›ä½¿ç”¨å®ƒä½†ç¼ºå°‘ç»´æŠ¤äººå‘˜ä¸ºå…¶è®¾è®¡åº”ç”¨ç¨‹åºçš„ç¯å¢ƒçš„ç”¨æˆ·ã€‚

åœ¨æœ¬èŠ‚ä¸­:

- 4.1 [å®¹å™¨åŒ– CLI](#41-%E5%AE%B9%E5%99%A8%E5%8C%96CLI)
- 4.2 [ä¼˜é›…é™çº§](#42-%E4%BC%98%E9%9B%85%E9%99%8D%E7%BA%A7)
- 4.3 [Node.js ç‰ˆæœ¬å…¼å®¹æ€§](#43-Node.js%E7%89%88%E6%9C%AC%E5%85%BC%E5%AE%B9%E6%80%A7)
- 4.4 [Shebang è‡ªåŠ¨æ£€æµ‹ Node.js è¿è¡Œæ—¶](#44-Shebang%E8%87%AA%E5%8A%A8%E6%A3%80%E6%B5%8BNode.js%E8%BF%90%E8%A1%8C%E6%97%B6)

### 4.1 å®¹å™¨åŒ– CLI

âœ… **å¯è¡Œ:** ä¸º CLI åˆ›å»ºä¸€ä¸ª docker æ˜ åƒï¼Œå¹¶å°†å…¶å‘å¸ƒåˆ° Docker Hub ä¹‹ç±»çš„å…¬å…±æ³¨å†Œè¡¨ä¸­ï¼Œä»¥ä¾¿æ²¡æœ‰ Node.js ç¯å¢ƒçš„ç”¨æˆ·å¯ä»¥ä½¿ç”¨å®ƒã€‚

âŒ **å¦åˆ™:** æ²¡æœ‰ Node.js ç¯å¢ƒçš„ç”¨æˆ·å°†æ²¡æœ‰ `npm` æˆ– `npx` å¯ç”¨ï¼Œå› æ­¤å°†æ— æ³•è¿è¡Œæ‚¨çš„ CLI åº”ç”¨ç¨‹åºã€‚

â„¹ï¸ **è¯¦æƒ…**

ä» npm æ³¨å†Œè¡¨ä¸­å®‰è£… Node.js CLI åº”ç”¨ç¨‹åºé€šå¸¸å°†ä½¿ç”¨ Node.js æœ¬æœºå·¥å…·é“¾ï¼ˆä¾‹å¦‚ `npm` æˆ– `npx`ã€‚è¿™äº›åœ¨ JavaScript å’Œ Node.js å¼€å‘äººå‘˜ä¸­å¾ˆå¸¸è§ï¼Œå¹¶ä¸”æœ‰æœ›åœ¨å®‰è£…è¯´æ˜ä¸­å¼•ç”¨ã€‚ è¿™äº›åœ¨ JavaScript å’Œ Node.js å¼€å‘è€…ä¸­æ˜¯å¸¸è§çš„ï¼Œé¢„è®¡å°†åœ¨å®‰è£…è¯´æ˜ä¸­è¢«å¼•ç”¨ã€‚

ç„¶è€Œï¼Œå¦‚æœä½ é’ˆå¯¹çš„æ˜¯æ™®é€šç”¨æˆ·æ¶ˆè´¹çš„ CLI åº”ç”¨ç¨‹åºï¼Œä¸ç®¡ä»–ä»¬æ˜¯å¦ç†Ÿæ‚‰JavaScriptï¼Œ æˆ–æ­¤å·¥å…·çš„å¯ç”¨æ€§ï¼Œç„¶ååªèƒ½ä» npm æ³¨å†Œè¡¨ä¸­ä»¥å®‰è£…å½¢å¼åˆ†å‘æ‚¨çš„ CLI åº”ç”¨å°†å—åˆ°é™åˆ¶ã€‚ ä½†æ˜¯ï¼Œå¦‚æœæ‚¨å°† CLI ç¨‹åºä½œä¸ºæ™®é€šå¤§ä¼—ä½¿ç”¨ï¼Œè€Œä¸ç®¡ä»–ä»¬æ˜¯å¦ç†Ÿæ‚‰ JavaScript æˆ–è¯¥å·¥å…·çš„å¯ç”¨æ€§ï¼Œé‚£ä¹ˆä»…ä»¥ npm æ³¨å†Œè¡¨ä¸­çš„å®‰è£…å½¢å¼åˆ†å‘ CLI ç¨‹åºå°†å—åˆ°é™åˆ¶ã€‚å¦‚æœæ‚¨çš„ CLI åº”ç”¨ç¨‹åºæ‰“ç®—åœ¨æ„å»ºæˆ– CI ç¯å¢ƒä¸­ä½¿ç”¨ï¼Œé‚£ä¹ˆå®‰è£… Node.js ç›¸å…³çš„å·¥å…·é“¾ä¾èµ–é¡¹å¯èƒ½ä¹Ÿéœ€è¦è¿™äº›ã€‚

æ‰“åŒ…å’Œåˆ†å‘å¯æ‰§è¡Œæ–‡ä»¶çš„æ–¹æ³•æœ‰å¾ˆå¤šï¼Œå°†å…¶å®¹å™¨åŒ–ä¸ºä¸ CLI åº”ç”¨ç¨‹åºé¢„å…ˆæ†ç»‘åœ¨ä¸€èµ·çš„ Docker å®¹å™¨æ˜¯ä¸€ç§æ˜“äºä½¿ç”¨çš„é€‰æ‹©ï¼Œå¹¶ä¸”æ²¡æœ‰ä¾èµ–æ€§ï¼ˆé™¤äº†éœ€è¦ Docker ç¯å¢ƒä¹‹å¤–ï¼‰ã€‚

### 4.2 ä¼˜é›…é™çº§

âœ… **å¯è¡Œ:** ä¸ºç”¨æˆ·æä¾›åœ¨ä¸å—æ”¯æŒçš„ç¯å¢ƒä¸­é€‰æ‹©é€€å‡ºå½©è‰²å’Œä¸°å¯ŒåŠ¨ç”»æ˜¾ç¤ºçš„èƒ½åŠ›ï¼Œä¾‹å¦‚é€šè¿‡è·³è¿‡äº¤äº’æ€§å¹¶ä»¥ JSON å½¢å¼æä¾›æ ¼å¼åŒ–è¾“å‡ºã€‚

âŒ **å¦åˆ™:** å¯¹äºæ²¡æœ‰å—æ”¯æŒç»ˆç«¯çš„ç”¨æˆ·ï¼Œä½¿ç”¨ç»ˆç«¯äº¤äº’(å¦‚æç¤ºå’Œå…¶ä»–æ˜¾ç¤ºä¸°å¯Œçš„ç•Œé¢)å¯èƒ½ä¼šæ˜¾è‘—é™ä½æœ€ç»ˆç”¨æˆ·ä½“éªŒï¼Œå¹¶é˜»ç¢ä»–ä»¬ä½¿ç”¨ CLI åº”ç”¨ç¨‹åºï¼Œå› ä¸ºå®ƒå…·æœ‰ä¸°å¯Œå¤šå½©çš„è¾“å‡ºã€‚

â„¹ï¸ **è¯¦æƒ…**

é€šå¸¸ä»¥å½©è‰²è¾“å‡ºçš„å½¢å¼æä¾›ä¸°å¯Œçš„ç»ˆç«¯æ˜¾ç¤ºå™¨ï¼Œ ascii å›¾è¡¨ï¼Œç”šè‡³åœ¨ç»ˆç«¯å’Œå¼ºå¤§çš„å¿«é€Ÿæœºåˆ¶ä¸ŠåŠ¨ç”»ã€‚ å¯¹äºé‚£äº›æ‹¥æœ‰æ”¯æŒçš„ç»ˆç«¯çš„äººæ¥è¯´ï¼Œè¿™äº›å¯èƒ½æœ‰åŠ©äºæå¥½çš„ç”¨æˆ·ä½“éªŒï¼Œä½†æ˜¯ï¼Œå¯¹äºé‚£äº›æ²¡æœ‰ç»ˆç«¯çš„äººæ¥è¯´ï¼Œå®ƒå¯èƒ½ä¼šæ˜¾ç¤ºä¹±ç æ–‡æœ¬æˆ–å®Œå…¨æ— æ³•æ“ä½œã€‚

è¦ä½¿ç»ˆç«¯ä¸å—æ”¯æŒçš„ç”¨æˆ·èƒ½å¤Ÿæ­£ç¡®ä½¿ç”¨ Node.js CLI åº”ç”¨ç¨‹åºï¼Œæ‚¨å¯ä»¥é€‰æ‹©ï¼š

- è‡ªåŠ¨æ£€æµ‹ç»ˆç«¯åŠŸèƒ½ï¼Œå¹¶åœ¨è¿è¡Œæ—¶è¯„ä¼°æ˜¯å¦é™ä½ CLI äº¤äº’æ€§
- ä¸ºç”¨æˆ·æä¾›é€‰æ‹©åŠ å…¥ï¼Œä»¥æ˜¾å¼åˆ‡æ¢ä¼˜é›…é™çº§ï¼Œä¾‹å¦‚é€šè¿‡æä¾› `--json` å‘½ä»¤è¡Œå‚æ•°å¼ºåˆ¶å…¶è¾“å‡ºåŸå§‹æ•°æ®ã€‚

```
ğŸ‘ æç¤º

  æ”¯æŒä¼˜é›…çš„é™çº§ï¼ˆå¦‚ JSON è¾“å‡ºï¼‰ä¸ä»…å¯¹æœ€ç»ˆç”¨æˆ·åŠå…¶ä¸å—æ”¯æŒçš„ç»ˆç«¯æœ‰ç”¨ï¼Œè€Œä¸”å¯¹äºåœ¨æŒç»­é›†æˆç¯å¢ƒä¸­è¿è¡Œä¹Ÿå¾ˆæœ‰ä»·å€¼ï¼Œå¹¶ä¸”ä½¿ç”¨æˆ·èƒ½å¤Ÿå°†æ‚¨çš„ç¨‹åºçš„è¾“å‡ºä¸å…¶ä»–ç¨‹åºçš„è¾“å…¥æˆ–å¯¼å‡ºæ•°æ®ï¼ˆå¦‚æœéœ€è¦ï¼‰è¿æ¥èµ·æ¥ã€‚
```

### 4.3 Node.js ç‰ˆæœ¬å…¼å®¹æ€§

âœ… **å¯è¡Œ:** ç¡®å®šå—æ”¯æŒå’Œç»´æŠ¤çš„ [Node.js ç‰ˆæœ¬](https://nodejs.org/en/about/releases)ã€‚

âŒ **å¦åˆ™:** è¯•å›¾ä¸è¾ƒæ—§ä¸”ä¸å—æ”¯æŒçš„ Node.js ç‰ˆæœ¬ä¿æŒå…¼å®¹çš„ä»£ç åº“å°†å¾ˆéš¾ç»´æŠ¤ï¼Œå¹¶ä¸”ä¼šå¤±å»è¯­è¨€å’Œè¿è¡Œæ—¶åŠŸèƒ½çš„å¥½å¤„ã€‚

â„¹ï¸ **è¯¦æƒ…**

æœ‰æ—¶å¯èƒ½éœ€è¦ä¸“é—¨é’ˆå¯¹ç¼ºå°‘æ–°çš„ ECAMScript åŠŸèƒ½çš„æ—§ç‰ˆæœ¬Node.jsã€‚ ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨è¦æ„å»ºä¸»è¦ç”¨äº DevOps æˆ– IT çš„ Node.js CLIï¼Œåˆ™å®ƒä»¬å¯èƒ½æ²¡æœ‰ç†æƒ³çš„ Node.js ç¯å¢ƒï¼Œå¹¶ä¸”å…·æœ‰æœ€æ–°çš„è¿è¡Œæ—¶ç¯å¢ƒã€‚ä½œä¸ºå‚è€ƒï¼ŒDebian Stretch(oldstable) ä¸ [Node.js 8.11.1](https://packages.debian.org/search?suite=default%C2%A7ion=all&arch=any&searchon=names&keywords=nodejs) ä¸€èµ·æä¾›ã€‚ ä½œä¸ºå‚è€ƒï¼ŒDebian Stretch (è€ç¨³å®šç‰ˆæœ¬)å¸¦æœ‰ [Node.js 8.11.1](https://packages.debian.org/search?suite=default&section=all&arch=any&searchon=names&keywords=nodejs)

å¦‚æœæ‚¨ç¡®å®éœ€è¦é’ˆå¯¹ Node.js çš„æ—§ç‰ˆæœ¬ï¼Œå¦‚ Node.js8ã€6 æˆ– 4ï¼Œæ‰€æœ‰è¿™äº›ç‰ˆæœ¬éƒ½å·²åœæ­¢ä½¿ç”¨ï¼Œé‚£ä¹ˆæ‚¨æ›´å–œæ¬¢ä½¿ç”¨è¯¸å¦‚ Babel è¿™æ ·çš„ä»£ç è½¬æ¢ç¨‹åºæ¥ç¡®ä¿ç”Ÿæˆçš„ä»£ç ç¬¦åˆ V8 JavaScript å¼•æ“çš„ç‰ˆæœ¬ä»¥åŠè¿™äº›ç‰ˆæœ¬é™„å¸¦çš„ Node.js è¿è¡Œæ—¶ã€‚

å¦ä¸€ä¸ªè§£å†³æ–¹æ³•æ˜¯æä¾› CLI çš„å®¹å™¨ç‰ˆæœ¬ï¼Œä»¥é¿å…æ—§ç›®æ ‡ã€‚ è¯·å‚è§ [(4.1)å®¹å™¨åŒ– CLI](#containerize-the-cli)ã€‚

ä¸è¦ç²¾ç®€ç¨‹åºä»£ç ï¼Œä»¥ä½¿ç”¨ä¸æœªç»´æŠ¤æˆ– EOL Node.js ç‰ˆæœ¬åŒ¹é…çš„æ—§ ECMAScript è¯­è¨€è§„èŒƒï¼Œå› ä¸ºè¿™åªä¼šå¯¼è‡´ä»£ç ç»´æŠ¤é—®é¢˜ã€‚

å¦‚æœåœ¨ä¸å—æ”¯æŒçš„ç¯å¢ƒä¸­è°ƒç”¨ CLIï¼Œè¯·å°è¯•å¯¹å…¶è¿›è¡Œæ£€æµ‹ï¼Œå¹¶é€šè¿‡æè¿°æ€§é”™è¯¯æ¶ˆæ¯é€€å‡ºä»¥æ˜¾ç¤ºå‹å¥½çš„ä¿¡æ¯é”™è¯¯æ¶ˆæ¯ã€‚ è¯·å‚é˜… [æ­¤ç¤ºä¾‹](https://github.com/lirantal/dockly/blob/42d8c09631bc5348f108a50c3ce9601851fb760b/index.js#L25) ä»¥äº†è§£æ›´å¤šä¿¡æ¯ã€‚

### 4.4 Shebang è‡ªåŠ¨æ£€æµ‹ Node.js è¿è¡Œæ—¶

âœ… **å¯è¡Œ:** åœ¨ [Shebang](%E2%80%9Chttps://en.wikipedia.org/wiki/Shebang_(Unix)%E2%80%9D) å£°æ˜ä¸­ä½¿ç”¨ä¸å®‰è£…æ— å…³çš„å¼•ç”¨ï¼Œè¯¥å£°æ˜æ ¹æ®è¿è¡Œæ—¶ç¯å¢ƒè‡ªåŠ¨å®šä½ node.js è¿è¡Œæ—¶ï¼Œä¾‹å¦‚ `#!/usr/bin/env node`ã€‚

âŒ **å¦åˆ™:** ä½¿ç”¨ç¡¬ç¼–ç çš„ Node.js è¿è¡Œæ—¶ä½ç½®ï¼ˆå¦‚ `#!/usr/local/bin/node`ï¼‰ä»…é€‚ç”¨äºæ‚¨è‡ªå·±çš„ç¯å¢ƒï¼Œå¯èƒ½ä¼šå¯¼è‡´ Node.js CLI åœ¨ Node.js ä½ç½®ä¸åŒçš„å…¶ä»–ç¯å¢ƒä¸­æ— æ³•è¿è¡Œã€‚

â„¹ï¸ **è¯¦æƒ…**

é€šè¿‡å°†å…¥å£ç‚¹æ–‡ä»¶ä½œä¸º `node cli.js` è¿è¡Œï¼Œç„¶åå°† `#!/usr/local/bin/node` æ·»åŠ åˆ° `cli.js` æ–‡ä»¶çš„é¡¶éƒ¨ï¼Œå¼€å‘ Node.js CLI å¯èƒ½æ˜¯ä¸€ä¸ªç®€å•çš„å¼€å§‹ï¼Œä½†æ˜¯åè€…ä»ç„¶æ˜¯ä¸€ç§æœ‰ç¼ºé™·çš„æ–¹æ³•ï¼Œå› ä¸ºæ— æ³•ä¸ºå…¶ä»–ç”¨æˆ·çš„ç¯å¢ƒä¿è¯ `node` å¯æ‰§è¡Œæ–‡ä»¶çš„ä½ç½®ã€‚

åº”è¯¥æ³¨æ„çš„æ˜¯ï¼Œå°† `#!/usr/bin/env node` æŒ‡å®šä¸ºæœ€ä½³å®è·µï¼Œä»ç„¶å‡è®¾ Node.js è¿è¡Œæ—¶è¢«å¼•ç”¨ä¸º `node` è€Œä¸æ˜¯ `nodejs` æˆ–å…¶ä»–ã€‚

# 5 æµ‹è¯•

åœ¨æœ¬èŠ‚ä¸­:

- 5.1 [ä¸ä¿¡ä»»è¯­è¨€ç¯å¢ƒ](#51-%E4%B8%8D%E4%BF%A1%E4%BB%BB%E8%AF%AD%E8%A8%80%E7%8E%AF%E5%A2%83)

### 5.1 ä¸ä¿¡ä»»è¯­è¨€ç¯å¢ƒ

âœ… **å¯è¡Œ:** ä¸è¦å‡è®¾è¾“å‡ºæ–‡æœ¬ç­‰åŒäºæ‚¨å£°æ˜çš„å­—ç¬¦ä¸²ï¼Œå› ä¸ºæµ‹è¯•å¯èƒ½ä¼šåœ¨ä¸æ‚¨çš„è¯­è¨€ç¯å¢ƒä¸åŒæˆ–è‹±è¯­é»˜è®¤è¯­è¨€çš„ç³»ç»Ÿä¸Šè¿è¡Œã€‚

âŒ **å¦åˆ™:** å¼€å‘äººå‘˜åœ¨ä¸è‹±è¯­é»˜è®¤è¯­è¨€ç¯å¢ƒä¸åŒçš„ç³»ç»Ÿä¸Šæµ‹è¯•æ—¶ï¼Œå°†ä¼šé‡åˆ°æµ‹è¯•å¤±è´¥çš„æƒ…å†µã€‚

â„¹ï¸ **è¯¦æƒ…**

å½“æ‚¨é€‰æ‹©é€šè¿‡è¿è¡Œ CLI å¹¶åˆ†æè¾“å‡ºæ¥æµ‹è¯• CLI æ—¶ï¼Œæ‚¨å¯èƒ½å€¾å‘äº grep ç‰¹å®šåŠŸèƒ½ï¼Œä»¥ç¡®ä¿å®ƒä»¬å­˜åœ¨äºè¾“å‡ºä¸­ï¼Œä¾‹å¦‚åœ¨ä¸å¸¦å‚æ•°çš„æƒ…å†µä¸‹è¿è¡Œ CLI æ—¶æ­£ç¡®æä¾›ç¤ºä¾‹ã€‚ä¾‹å¦‚ï¼š e.g:

```js
const output = execSync(cli);
expect(output).to.contain("Examples:"));
```

å¦‚æœæµ‹è¯•å°†åœ¨éè‹±è¯­çš„è¯­è¨€ç¯å¢ƒä¸­è¿è¡Œï¼Œå¹¶ä¸”å¦‚æœæ‚¨çš„ CLI å‚æ•°è§£æåº“æ”¯æŒè¯­è¨€ç¯å¢ƒçš„è‡ªåŠ¨æ£€æµ‹å¹¶é‡‡ç”¨è¯¥è¯­è¨€ç¯å¢ƒï¼Œåˆ™ç”±äºä» `Examples` åˆ°ã€Œè¯­è¨€ç¯å¢ƒã€çš„è¯­è¨€è½¬æ¢ï¼Œæ­¤ç±»æµ‹è¯•å°†å¤±è´¥ã€‚ç­‰æ•ˆè¯­è¨€è¢«è®¾ç½®ä¸ºç³»ç»Ÿä¸­çš„é»˜è®¤è¯­è¨€ç¯å¢ƒã€‚

# 6 é”™è¯¯

æœ¬èŠ‚ä»‹ç»äº†æœ‰å…³ä½¿ Node.js CLI åº”ç”¨ç¨‹åºå¯ä¾›å¸Œæœ›ä½¿ç”¨å®ƒä½†ç¼ºä¹ç»´æŠ¤äººå‘˜ä¸ºå…¶è®¾è®¡åº”ç”¨ç¨‹åºçš„ç†æƒ³ç¯å¢ƒçš„ç”¨æˆ·ä½¿ç”¨çš„æœ€ä½³å®è·µã€‚

æœ¬è´¨ä¸Šï¼Œæœ¬èŠ‚ä¸­åˆ—å‡ºçš„æœ€ä½³å®è·µçš„ç›®æ ‡æ˜¯å¸®åŠ©ç”¨æˆ·å¿«é€Ÿè½»æ¾åœ°æ’æŸ¥é”™è¯¯ï¼Œè€Œæ— éœ€æŸ¥é˜…æ–‡æ¡£æˆ–æºä»£ç æ¥æŸ¥æ‰¾é”™è¯¯ã€‚

åœ¨æœ¬èŠ‚ä¸­:

- 6.1 [å¯è¿½è¸ªçš„é”™è¯¯](#61-%E4%BF%A1%E6%81%AF%E6%80%A7%E9%94%99%E8%AF%AF)
- 6.2 [å¯è¡Œæ€§é”™è¯¯](#62-%E5%8F%AF%E8%A1%8C%E6%80%A7%E9%94%99%E8%AF%AF)
- 6.3 [æä¾›è°ƒè¯•æ¨¡å¼](#63-%E6%8F%90%E4%BE%9B%E8%B0%83%E8%AF%95%E6%A8%A1%E5%BC%8F)
- 6.4 [æ­£ç¡®ä½¿ç”¨é€€å‡ºä»£ç ](#64-%E6%AD%A3%E7%A1%AE%E4%BD%BF%E7%94%A8%E9%80%80%E5%87%BA%E4%BB%A3%E7%A0%81)
- 6.5 [è½»æ¾çš„é”™è¯¯æŠ¥å‘Š](#65-è½»æ¾çš„é”™è¯¯æŠ¥å‘Š)

### 6.1 å¯è¿½è¸ªçš„é”™è¯¯

âœ… **å¯è¡Œ:** æŠ¥å‘Šé”™è¯¯æ—¶ï¼Œæä¾›å¯ä»¥åœ¨é¡¹ç›®æ–‡æ¡£ä¸­æŸ¥æ‰¾çš„å¯è·Ÿè¸ªé”™è¯¯ä»£ç ï¼Œä»è€Œç®€åŒ–å¯¹é”™è¯¯æ¶ˆæ¯çš„æ•…éšœæ’é™¤ã€‚

å¦‚æœå¯èƒ½ï¼Œè¯·ä½¿ç”¨æ›´å¤šä¿¡æ¯æ‰©å±•è·Ÿè¸ªé”™è¯¯ä»£ç ï¼Œä»¥ä¾¿å¯ä»¥è½»æ¾åˆ†æè¿™äº›é”™è¯¯æ¶ˆæ¯å¹¶å¼„æ¸…ä¸Šä¸‹æ–‡ã€‚

âŒ **å¦åˆ™:** ä¸€èˆ¬çš„é”™è¯¯æ¶ˆæ¯å¾€å¾€æ˜¯æ¨¡æ£±ä¸¤å¯çš„ï¼Œä½¿ç”¨æˆ·å¾ˆéš¾æœç´¢è§£å†³æ–¹æ¡ˆã€‚è§£æå’Œåˆ†æä¸æ˜¯é‚£ä¹ˆç®€å•ï¼Œåœ¨æ–‡æ¡£ä¸­å¼•ç”¨å®ƒä»¬ä¹Ÿä¸æ˜¯é‚£ä¹ˆæ¸…æ™°ã€‚ è§£æå’Œåˆ†æä¸å¤Ÿç›´æˆªäº†å½“ï¼Œåœ¨æ–‡æ¡£ä¸­å¼•ç”¨å®ƒä»¬ä¹Ÿä¸ä¼šé‚£ä¹ˆå¹²å‡€ã€‚

â„¹ï¸ **è¯¦æƒ…**

è¿”å›é”™è¯¯æ¶ˆæ¯æ—¶ï¼Œè¯·ç¡®ä¿å®ƒä»¬åŒ…å«å‚è€ƒå·æˆ–ç‰¹å®šçš„é”™è¯¯ä»£ç ï¼Œä»¥ä¾¿ä»¥åæŸ¥é˜…ã€‚ä¸ HTTP çŠ¶æ€ä»£ç éå¸¸ç›¸ä¼¼ï¼Œå› æ­¤ CLI åº”ç”¨ç¨‹åºéœ€è¦å‘½åæˆ–ç¼–ç é”™è¯¯ã€‚ å°±åƒHTTPçŠ¶æ€ç ä¸€æ ·ï¼ŒCLIåº”ç”¨ç¨‹åºéœ€è¦å‘½åæˆ–ç¼–ç é”™è¯¯ã€‚

ä¾‹å­ï¼š

```sh
$ my-cli-tool --doSomething

Error (E4002): please provide an API token via environment variables
```

### 6.2 å¯è¡Œæ€§é”™è¯¯

âœ… **å¯è¡Œ:** å¤±è´¥çš„é”™è¯¯æ¶ˆæ¯åº”è¯¥å‘Šè¯‰ç”¨æˆ·éœ€è¦ä¿®å¤ä»€ä¹ˆï¼Œè€Œä¸æ˜¯æŠ±æ€¨æœ‰é”™è¯¯ã€‚

âŒ **å¦åˆ™:** é¢å¯¹é”™è¯¯æ¶ˆæ¯ä¸”æœªæç¤ºè§£å†³é”™è¯¯çš„æ“ä½œçš„ç”¨æˆ·å¯èƒ½æ— æ³•æˆåŠŸä½¿ç”¨æ‚¨çš„ CLI åº”ç”¨ç¨‹åºã€‚

â„¹ï¸ **è¯¦æƒ…**

ç¤ºä¾‹ï¼š

```sh
$ my-cli-tool --doSomething

Error (E4002): please provide an API token via environment variables
```

### 6.3 æä¾›è°ƒè¯•æ¨¡å¼

âœ… **å¯è¡Œ:** å¦‚æœéœ€è¦è¯Šæ–­é—®é¢˜ï¼Œè¯·å…è®¸é«˜çº§ç”¨æˆ·å¯ç”¨æ›´è¯¦ç»†çš„ä¿¡æ¯ã€‚

âŒ **å¦åˆ™:** ä¸è¦è·³è¿‡è°ƒè¯•åŠŸèƒ½ã€‚ æ”¶é›†ç”¨æˆ·çš„åé¦ˆï¼Œè®©ä»–ä»¬æ‰¾å‡ºé”™è¯¯çš„åŸå› å°†ä¼šæ¯”è¾ƒå›°éš¾ã€‚

â„¹ï¸ **Details**

ä½¿ç”¨ç¯å¢ƒå˜é‡ä»¥åŠå‘½ä»¤è¡Œå‚æ•°æ¥å¯ç”¨æ‰©å±•çš„è°ƒè¯•è¯¦ç»†çº§åˆ«ã€‚Â åœ¨æ‚¨çš„ä»£ç ä¸­æœ‰æ„ä¹‰çš„åœ°æ–¹ï¼Œæ¤å…¥æœ‰åŠ©äºç”¨æˆ·å’Œç»´æŠ¤è€…ç†è§£ç¨‹åºæµã€è¾“å…¥å’Œè¾“å‡ºä»¥åŠå…¶ä»–ä½¿é—®é¢˜è§£å†³æ›´å®¹æ˜“çš„è°ƒè¯•æ¶ˆæ¯ã€‚

ğŸ“¦ **æ¨èçš„è½¯ä»¶åŒ…**

å¯¹å¼€æº Node.js åŒ…çš„å‚è€ƒï¼š

- [debug](https://www.npmjs.com/package/debug)

### 6.4 æ­£ç¡®ä½¿ç”¨é€€å‡ºä»£ç 

âœ… **å¯è¡Œ:** ä½¿ç”¨é€‚å½“çš„é€€å‡ºä»£ç ç»ˆæ­¢ç¨‹åºï¼Œè¿™äº›é€€å‡ºä»£ç å¯ä»¥ä¼ è¾¾é”™è¯¯æˆ–é€€å‡ºçŠ¶æ€çš„è¯­ä¹‰å«ä¹‰ã€‚

âŒ **å¦åˆ™:** ä¸æ­£ç¡®æˆ–ç¼ºå¤±çš„é€€å‡ºä»£ç å°†é˜»ç¢ CLI åœ¨æŒç»­é›†æˆæµç¨‹å’Œå…¶ä»–å‘½ä»¤è¡Œè„šæœ¬ç¼–å†™ç”¨ä¾‹ä¸­çš„ä½¿ç”¨ã€‚

â„¹ï¸ **è¯¦æƒ…**

å‘½ä»¤è¡Œè„šæœ¬ç»å¸¸åˆ©ç”¨ shell çš„ `$?` æ¨æ–­ç¨‹åºçš„çŠ¶æ€ç å¹¶å¯¹å…¶æ‰§è¡Œæ“ä½œã€‚ åœ¨æŒç»­é›†æˆ (CI) æµç¨‹ä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨å®ƒæ¥ç¡®å®šæ­¥éª¤æ˜¯å¦æˆåŠŸå®Œæˆã€‚

å¦‚æœæ‚¨çš„ CLI æ€»æ˜¯ä»¥æ²¡æœ‰ç‰¹å®šçŠ¶æ€ç çš„æ–¹å¼ç»ˆæ­¢ï¼Œå³ä½¿å‡ºç°é”™è¯¯ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œé‚£ä¹ˆä¾èµ–äºå®ƒçš„ Shell å’Œå…¶ä»–ç¨‹åºå°†æ— æ³•å¾—çŸ¥ã€‚ å½“å‘ç”Ÿé”™è¯¯å¯¼è‡´ç¨‹åºç»ˆæ­¢æ—¶ï¼Œæ‚¨åº”è¯¥ä¼ è¾¾è¿™ç§å«ä¹‰ã€‚ ä¾‹å¦‚ï¼š

```js
try {
  // something
} catch (err) {
  // cleanup or otherwise
  // then exit with proper status code
  process.exit(1);
}
```

é€€å‡ºä»£ç çš„ç®€çŸ­å‚è€ƒï¼š

- é€€å‡ºä»£ç  0 è¡¨ç¤ºæˆåŠŸæ‰§è¡Œ
- é€€å‡ºä»£ç  1 è¡¨ç¤ºå¤±è´¥

æ‚¨ä¹Ÿå¯ä»¥é€‰æ‹©ä½¿ç”¨å…·æœ‰ç¨‹åºè¯­ä¹‰çš„è‡ªå®šä¹‰é€€å‡ºä»£ç ï¼Œä½†æ˜¯å¦‚æœè¿™æ ·åšï¼Œè¯·ç¡®ä¿æ­£ç¡®è®°å½•å®ƒä»¬ã€‚

å‚è€ƒï¼šBASH shell ä½¿ç”¨çš„ [é€€å‡ºä»£ç åˆ—è¡¨](http://www.tldp.org/LDP/abs/html/exitcodes.html)

### 6.5 è½»æ¾çš„é”™è¯¯æŠ¥å‘Š

âœ… **å¯è¡Œ:** é€šè¿‡æä¾›ä¸€ä¸ª URL æ¥æ‰“å¼€é—®é¢˜å¹¶å°½å¯èƒ½å¤šçš„é¢„å¡«å……æ‰€éœ€çš„æ•°æ®ï¼Œä½¿æäº¤é”™è¯¯æŠ¥å‘Šå˜å¾—è½»æ¾ã€‚[é—®é¢˜æ¨¡æ¿ï¼Œä¾‹å¦‚åœ¨ GitHub ä¸Š](https://docs.github.com/en/free-pro-team@latest/github/building-a-strong-community/configuring-issue-templates-for-your-repository)ï¼Œå…è®¸è¿›ä¸€æ­¥æŒ‡å¯¼ç”¨æˆ·å“ªäº›ä¿¡æ¯æ˜¯å¿…è¦çš„ã€‚ [é—®é¢˜æ¨¡æ¿ï¼Œå¦‚åœ¨ GitHub](https://docs.github.com/en/free-pro-team@latest/github/building-a-strong-community/configuring-issue-templates-for-your-repository)ä¸Šï¼Œå…è®¸è¿›ä¸€æ­¥å¼•å¯¼ç”¨æˆ·äº†è§£å“ªäº›ä¿¡æ¯æ˜¯å¿…è¦çš„ã€‚

âŒ **å¦åˆ™:** ç”¨æˆ·åœ¨æœç´¢å¦‚ä½•æŠ¥å‘Šé”™è¯¯æ—¶æ„Ÿåˆ°æ²®ä¸§ï¼Œæœ€ç»ˆå¯èƒ½å¾—ä¸åˆ°æœ‰ç”¨çš„ä¿¡æ¯ï¼Œæˆ–è€…æ ¹æœ¬ä¸æäº¤é—®é¢˜ã€‚

# 7 å¼€å‘

æœ¬èŠ‚ä»‹ç»äº†æ„å»º Node.js å‘½ä»¤è¡Œåº”ç”¨ç¨‹åºçš„å¼€å‘å’Œç»´æŠ¤æœ€ä½³å®è·µã€‚

åœ¨æœ¬èŠ‚ä¸­:

- 7.1 [ä½¿ç”¨ bin å¯¹è±¡](#71-%E4%BD%BF%E7%94%A8bin%E5%AF%B9%E8%B1%A1)
- 7.2 [ä½¿ç”¨ç›¸å¯¹è·¯å¾„](#72-ä½¿ç”¨ç›¸å¯¹è·¯å¾„)
- 7.3 [ä½¿ç”¨ files å­—æ®µ](#73-ä½¿ç”¨fileså­—æ®µ)

### 7.1 ä½¿ç”¨ bin å¯¹è±¡

âœ… **å¯è¡Œï¼š** ä½¿ç”¨ä¸€ä¸ªå¯¹è±¡æ¥å®šä¹‰å¯æ‰§è¡Œæ–‡ä»¶çš„åç§°ä»¥åŠå…¶è·¯å¾„ã€‚

âŒ **å¦åˆ™ï¼š** æ‚¨æœ€ç»ˆå°†æŠŠç¨‹åºåŒ…çš„åç§°ä¸å¯æ‰§è¡Œæ–‡ä»¶è€¦åˆåœ¨ä¸€èµ·ã€‚

â„¹ï¸ **è¯¦æƒ…**

ä»¥ä¸‹ `package.json` æ˜¾ç¤ºäº†å°†å¯æ‰§è¡Œæ–‡ä»¶çš„åç§°ä¸æ–‡ä»¶ååŠå…¶åœ¨é¡¹ç›®ä¸­çš„ä½ç½®è§£è€¦çš„ç¤ºä¾‹ï¼š

```json
  "bin": {
    "myCli-is-cool": "./bin/myCli.js"
  }
```

### 7.2 ä½¿ç”¨ç›¸å¯¹è·¯å¾„

âœ… **å¯è¡Œï¼š** ä½¿ç”¨ `process.cwd()` è®¿é—®ç”¨æˆ·è¾“å…¥è·¯å¾„ï¼Œä½¿ç”¨ `__dirname` è®¿é—®åŸºäºé¡¹ç›®çš„è·¯å¾„ã€‚

âŒ **å¦åˆ™ï¼š** æ‚¨æœ€ç»ˆå°†è·å¾—ä¸æ­£ç¡®çš„æ–‡ä»¶è·¯å¾„ï¼Œå¹¶ä¸”å°†æ— æ³•è®¿é—®æ–‡ä»¶ã€‚

â„¹ï¸ **è¯¦æƒ…**

æ‚¨å¯èƒ½å‘ç°è‡ªå·±éœ€è¦è®¿é—®é¡¹ç›®æ–‡ä»¶èŒƒå›´å†…çš„æ–‡ä»¶ã€‚ æˆ–è€…è®¿é—®ç”¨æˆ·è¾“å…¥æä¾›çš„ æ–‡ä»¶ï¼Œå¦‚æ—¥å¿—ã€JSON æ–‡ä»¶æˆ–å…¶ä»–æ–‡ä»¶ã€‚ æ··æ·† `process.cwd()` å’Œ `__dirname` å¯èƒ½ä¼šå¯¼è‡´é”™è¯¯å¹¶ä¸”ä¸ä½¿ç”¨å…¶ä¸­ä»»æ„ä¸€ä¸ªã€‚

å¦‚ä½•æ­£ç¡®è®¿é—®æ–‡ä»¶ï¼š

- `process.cwd()`ï¼šå½“éœ€è¦è®¿é—®çš„æ–‡ä»¶è·¯å¾„ä¾èµ–äºç›¸å¯¹ä½ç½®æ—¶ä½¿ç”¨Node.js å‘½ä»¤è¡Œç•Œé¢ã€‚ ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­æ˜¯å½“ CLI æ”¯æŒåˆ›å»ºæ—¥å¿—çš„æ–‡ä»¶è·¯å¾„æ—¶ï¼Œä¾‹å¦‚ï¼š`myCli--outfil../../out.json`ã€‚ å¦‚æœ `myCli` å®‰è£…åœ¨ `/usr/local/node_modules/myCli/bin/myCli.js` ä¸­ï¼Œåˆ™ `process.cwd()` ä¸ä¼šå¼•ç”¨è¯¥ä½ç½®ï¼Œè€Œä¸æ˜¯å½“å‰å·¥ä½œç›®å½•ï¼Œå³ç”¨æˆ·æ‰€åœ¨çš„ç›®å½•è°ƒç”¨ CLI æ—¶ã€‚
- `__dirname`ï¼šå½“æ‚¨éœ€è¦ä» CLI çš„æºä»£ç ä¸­è®¿é—®æ–‡ä»¶å¹¶å¼•ç”¨ç›¸å…³æ–‡ä»¶æ—¶ä½¿ç”¨å®ƒä»£ç æ‰€åœ¨æ–‡ä»¶çš„ä½ç½®ã€‚ ä¾‹å¦‚ï¼Œå½“ CLI éœ€è¦è®¿é—®å¦ä¸€ä¸ªç›®å½•ä¸­çš„ JSON æ•°æ®æ–‡ä»¶æ—¶ï¼š`fs.readFile(path.join(__dirname, '..', 'myDataFile.json'))`ã€‚

### 7.3 ä½¿ç”¨ `files` å­—æ®µ

âœ… **å¯è¡Œï¼š** ä½¿ç”¨ `files` å­—æ®µä»…åœ¨å‘å¸ƒçš„è½¯ä»¶åŒ…ä¸­åŒ…å«å¿…è¦çš„æ–‡ä»¶ã€‚

âŒ **å¦åˆ™ï¼š** æœ€åï¼Œæ‚¨å°†å¾—åˆ°ä¸€ä¸ªè½¯ä»¶åŒ…ï¼Œå…¶ä¸­åŒ…å«è¿è¡Œ CLI åº”ç”¨ç¨‹åºå¯èƒ½ä¸éœ€è¦çš„æ–‡ä»¶ã€‚ ä¾‹å¦‚ï¼ˆæµ‹è¯•æ–‡ä»¶ï¼Œå¼€å‘é…ç½®ç­‰ï¼‰ã€‚

â„¹ï¸ **è¯¦æƒ…**

ä¸ºäº†ä¿æŒå·²å‘å¸ƒçš„ [åŒ…ä½“ç§¯å°](ï¼ƒ21-é€‰æ‹©å ç”¨è¾ƒå°çš„ä¾èµ–é¡¹)ï¼Œæˆ‘ä»¬åº”ä»…åŒ…å«æ–‡ä»¶ è¿è¡Œæˆ‘ä»¬çš„ CLI åº”ç”¨ç¨‹åºæ‰€éœ€çš„æ–‡ä»¶ã€‚æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§æ­¤ [æ–‡ç« ](https://medium.com/@nodejs/publishing-npm-packages-c4c615a0fc6b)ã€‚ æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§æ­¤ [æ–‡ç« ](https://medium.com/@nodejs/publishing-npm-packages-c4c615a0fc6b)ã€‚

ä»¥ä¸‹ `files` å­—æ®µå‘Šè¯‰ npm CLI å°† src ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶ï¼ˆåŒ…æ‹¬ spec æ–‡ä»¶ï¼‰éƒ½åŒ…æ‹¬åœ¨å†…ã€‚

```json
"files": [
  "src",
  "!src/**/*.spec.js"
],
```

# 8 åˆ†æ

æœ¬èŠ‚å¤„ç† Node.js å‘½ä»¤è¡Œåº”ç”¨ç¨‹åºä¸­çš„åˆ†æé›†åˆã€‚

åœ¨æœ¬èŠ‚ä¸­:

- 8.1 [ä¸¥æ ¼é€‰æ‹©åŠ å…¥åˆ†æ](#81-ä¸¥æ ¼é€‰æ‹©åŠ å…¥åˆ†æ)

### 8.1 ä¸¥æ ¼é€‰æ‹©åŠ å…¥åˆ†æ

âœ… **å¯è¡Œ:** å§‹ç»ˆä»¥æ˜ç¡®çš„æ–¹å¼æç¤ºã€è¯¢é—®æˆ–é€‰æ‹©ç”¨æˆ·å°†ä½¿ç”¨æƒ…å†µå’Œäº§å“åˆ†ææäº¤åˆ°è¿œç¨‹ä½ç½®ã€‚

âŒ **å¦åˆ™:** æ‚¨å¯èƒ½ä¼šæ‹…å¿ƒç”¨æˆ·çš„éšç§é—®é¢˜ä»¥åŠç”¨æˆ·æ„æƒ³ä¸åˆ°ä¸”ä»¤äººæƒŠè®¶çš„ CLI è¡Œä¸ºã€‚

â„¹ï¸ **è¯¦æƒ…**

å¯ä»¥ç†è§£ï¼Œä½œä¸º CLI åº”ç”¨ç¨‹åºçš„ç»´æŠ¤è€…ï¼Œæ‚¨å¸Œæœ›æ›´å¥½åœ°äº†è§£ç”¨æˆ·å¦‚ä½•ä½¿ç”¨å®ƒã€‚ å¯ä»¥ç†è§£ï¼Œä½œä¸º CLI åº”ç”¨ç¨‹åºçš„ç»´æŠ¤è€…ï¼Œæ‚¨å¸Œæœ›æ›´å¥½åœ°äº†è§£ç”¨æˆ·å¦‚ä½•ä½¿ç”¨å®ƒã€‚ ç„¶è€Œï¼Œåœ¨ä¸å¾å¾—ç”¨æˆ·åŒæ„çš„æƒ…å†µä¸‹ï¼Œå·å·åœ°å’Œé»˜è®¤çš„â€œç”µè¯å›å®¶â€ç±»å‹çš„è¡Œä¸ºä¼šå—åˆ°è°´è´£ã€‚

æŒ‡å—:

- è®©ç”¨æˆ·çŸ¥é“å°†æ”¶é›†å“ªäº›æ•°æ®ä»¥åŠæ‚¨å¦‚ä½•å¤„ç†è¿™äº›æ•°æ®ã€‚
- æ³¨æ„éšç§é—®é¢˜å¹¶æ”¶é›†æ½œåœ¨çš„ä¸ªäººèº«ä»½ä¿¡æ¯ã€‚
- æ•°æ®å­˜å‚¨çš„æ–¹å¼ã€åœ°ç‚¹å’Œæ—¶é—´æ®µã€‚

å…¶ä»–æ”¶é›†åˆ†æçš„ CLI çš„å‚è€ƒæ˜¯ [Angular CLI](https://angular.io/analytics) å’Œ [Next.js](https://nextjs.org/telemetry) CLIã€‚

# 9 Versioning

Following these best practices for version information in Node.js CLI apps enhances user experience, facilitates debugging, and ensures efficient project management.

In this section:

- 9.1 [Include a `--version` Flag](#91-include-a---version-flag)
- 9.2 [Use Semantic Versioning](#92-use-semantic-versioning)
- 9.3 [Provide Version Information in a 'package.json' file](#93-provide-version-information-in-a-packagejson-file)
- 9.4 [Display Version in Error Messages and Help Text](#94-display-version-in-error-messages-and-help-text)
- 9.5 [Backward Compatibility](#95-backward-compatibility)
- 9.6 [Publish Versioned Releases on npm](#96-publish-versioned-releases-on-npm)
- 9.7 [Update Your App's Version Documents](#97-update-your-apps-version-documents)

### 9.1. Include a `--version` Flag

âœ… **Do:** Use a proper flag to allow users to check the application's version easily.

âŒ **Otherwise:** Users won't know which version they are using, making it challenging to track updates or report issues accurately.

â„¹ï¸ **Details**

As the maintainer of the CLI project, you need to implement a functionality to display the program's version on standard output with the proper flag without any argument, and exit from the program(often also prints compiled-in configuration details as well). You can also use the `-V` as the short flag.

Example:

```sh
$ my-cli-tool --version

my-cli-tool version 11.0.5, build 11.0.5-0ubuntu1~22.04.1
```

### 9.2. Use Semantic Versioning

âœ… **Do:** Like other projects, use the SemVer format. It provides a clear, standardized way to convey version information, making it easier for users to understand the significance of updates.

âŒ **Otherwise:** Users might not understand the impact of updates, leading to confusion or unexpected behavior.

### 9.3. Provide Version Information in a 'package.json' file

âœ… **Do:** Try to add version information in `package.json` file because this ensures consistency across your project and makes it easy to automate version updates.

âŒ **Otherwise:** You and your program's users will face difficulty in tracking dependencies and managing the project's version.

â„¹ï¸ **Details**

Tools like `npm` or `yarn` offer version management features that simplify handling dependencies and versioning.

> ğŸ‘ Tip
> 
> Use the option of automating version increments that these tools bring, (e.g., `npm version`) to reduce the risk of human error and streamline the release process

### 9.4. Display Version in Error Messages and Help Text

âœ… **Do:** Provide the version in error messages so that users can include version information when reporting issues, aiding debugging and support.

âŒ **Otherwise:** Debugging becomes more challenging, and users might not know which version to reference when seeking help or even when they use your program as a dependency on other programs.

### 9.5. Backward Compatibility

âœ… **Do:** Ensuring backward compatibility with older versions of your app allows users to upgrade without breaking their workflows.

âŒ **Otherwise:** Frequent updates that break compatibility can frustrate users and hinder adoption.

â„¹ï¸ **Details**

Ensure that, even when you remove any functionality or change the format of input/outputs, you come with some description for the user.

> ğŸ‘ Tip
> 
> Use the document pages to provide an overview of features that are deprecated or soon going to be deprecated and their replacements. Display a message to your users and ask them to learn about the end of support for features by referring to the release notes.

Example:

```sh
DEPRECATED: The blah-blah-feat is deprecated and will be removed in a future release.
            Install the blah-feat component to do the blah:
            <https://url/to/docs>
```

### 9.6. Publish Versioned Releases on npm

âœ… **Do:** Publish your app on npm with version tags enabling users to easily install specific versions.

âŒ **Otherwise:** Users can't access previous versions, which might be necessary for compatibility or troubleshooting.

### 9.7. Update Your App's Version Documents

âœ… **Do:** Inform users about changes, enhancements, and bug fixes in each version by providing clear release notes; A changelog helps users understand what has changed between versions and whether it affects their use case.

âŒ **Otherwise:** Users won't know what to expect in new versions, which can lead to frustration or confusion. They also may struggle to assess whether they should upgrade or not.

# 10 Appendix: CLI Frameworks

### 10.1 CLI Frameworks Table

| åç§°         | ç®€ä»‹                                                                                                    | npm                                                         | GitHub                                                                           | å…³æ³¨ä»¥åŠä¸‹è½½é‡                                                                                                           |
| ---------- | ----------------------------------------------------------------------------------------------------- | ----------------------------------------------------------- | -------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------- |
| oclif      | æ„å»ºå‘½ä»¤è¡Œç•Œé¢çš„æ¡†æ¶ã€‚                                                                                           | [å‰å¾€ npm](https://www.npmjs.com/package/oclif)               | [å‰å¾€Github](https://github.com/oclif/oclif)                                       | ![](https://img.shields.io/github/stars/oclif/oclif)![](https://img.shields.io/npm/dt/oclif.svg)                  |
| inquire    | ä¸€ä¸ªé€šç”¨äº¤äº’å¼å‘½ä»¤è¡Œç”¨æˆ·ç•Œé¢ã€‚                                                                                       | [å‰å¾€ npm](https://www.npmjs.com/package/inquirer)            | [å‰å¾€Github](https://github.com/SBoudrias/Inquirer.js)                             | ![](https://img.shields.io/github/stars/sboudrias/inquirer.js)![](https://img.shields.io/npm/dt/inquirer.svg)     |
| ink        | Ink æä¾›äº†Reactåœ¨æµè§ˆå™¨ä¸­æä¾›çš„åŸºäºç»„ä»¶çš„ç”¨æˆ·ç•Œé¢æ„å»ºä½“éªŒï¼Œä½†æ˜¯æœ‰äº†å‘½ä»¤è¡Œåº”ç”¨çš„ä½“éªŒã€‚                                                       | [å‰å¾€ npm](https://www.npmjs.com/package/ink)                 | [å‰å¾€Github](https://github.com/vadimdemedes/ink)                                  | ![](https://img.shields.io/github/stars/vadimdemedes/ink)![](https://img.shields.io/npm/dt/ink.svg)               |
| pastel     | Next.js-like framework for CLIs made with Ink.                                                        | [å‰å¾€ npm](https://www.npmjs.com/package/pastel)              | [Link to Github](https://github.com/vadimdemedes/pastel)                         | ![](https://img.shields.io/github/stars/vadimdemedes/pastel)![](https://img.shields.io/npm/dt/pastel.svg)         |
| ink UI     | Collection of customizable UI components for CLIs made with Ink.                                      | [Link to npm](https://www.npmjs.com/package/@inkjs/ui)      | [Link to Github](https://github.com/vadimdemedes/ink-ui)                         | ![](https://img.shields.io/github/stars/vadimdemedes/ink-ui)![](https://img.shields.io/npm/dt/@inkjs/ui.svg)      |
| blessed    | ä¸€ä¸ªç±»ä¼¼æ›²çº¿çš„åº“ï¼Œä¸ºnode.jsè®¾ç½®ä¸€ä¸ªé«˜çº§ç»ˆç«¯ç•Œé¢ API ã€‚                                                                     | [Link to npm](https://www.npmjs.com/package/blessed)        | [Link to GitHub](https://github.com/chjj/blessed)                                | ![](https://img.shields.io/github/stars/chjj/blessed)![](https://img.shields.io/npm/dt/blessed.svg)               |
| prompts    | Lightweight, beautiful and user-friendly interactive prompts                                          | [Link to npm](https://npmjs.org/package/prompts)            | [Link to GitHub](https://github.com/terkelg/prompts)                             | ![](https://img.shields.io/github/stars/terkelg/prompts)![](https://img.shields.io/npm/dt/prompts.svg)            |
| vue-termui | A Vue.js based terminal UI framework that allows you to build modern terminal applications with ease. | [Link to npm](https://www.npmjs.org/package/vue-termui)     | [å‰å¾€Github](https://github.com/vue-terminal/vue-termui)                           | ![](https://img.shields.io/github/stars/vue-terminal/vue-termui)![](https://img.shields.io/npm/dt/vue-termui.svg) |
| clack      | Effortlessly build beautiful command-line apps                                                        | [Link to npm](https://www.npmjs.com/package/@clack/prompts) | [Link to GitHub](https://github.com/natemoo-re/clack/tree/main/packages/prompts) | ![](https://img.shields.io/github/stars/natemoo-re/clack)![](https://img.shields.io/npm/dt/@clack/prompts.svg)    |

# 11 Appendix: CLI educational resources

* https://clig.dev/
* https://primer.style/cli/getting-started/principles
* [@simonplend](https://twitter.com/simonplend) and [@dolearning](https://twitter.com/dolearning/)'s [workshop on crafting human friendly CLIs](https://github.com/simonplend/workshop-crafting-human-friendly-clis)

<!-- markdownlint-disable -->


<!-- markdownlint-enable -->

---

# ä½œè€…

**Node.js CLI Apps æœ€ä½³å®è·µ** Â© [Liran Tal](https://github.com/lirantal) ï¼Œæ ¹æ® [CC BY-SA 4.0](./LICENSE) è®¸å¯è¯å‘è¡Œã€‚

è¯¥é¡¹ç›®éµå¾ª[æ‰€æœ‰å‚ä¸è€…çš„](https://github.com/all-contributors/all-contributors)è§„èŒƒã€‚ æ¬¢è¿è¿›è¡Œä»»ä½•å½¢å¼çš„è´¡çŒ®ï¼

<!-- Project Logo -->
<!-- ALL-CONTRIBUTORS-BADGE:START - Do not remove or modify this section -->

[![All Contributors](https://img.shields.io/badge/all_contributors-6-orange.svg?style=flat-square)](#contributors-)

<!-- ALL-CONTRIBUTORS-BADGE:END -->

# è®¸å¯è¯

[![License](https://badgen.net/badge/License/CC%20BY-SA%204.0/green)](http://creativecommons.org/licenses/by-sa/4.0/)

æœ¬ä½œå“é‡‡ç”¨çŸ¥è¯†å…±äº«ç½²å-ShareAlike 4.0 å›½é™…è®¸å¯åè®®æˆæƒã€‚
